# AIå˜ç°ä¹‹è·¯ - ç³»ç»Ÿé…ç½®åå°ç®¡ç†æ–¹æ¡ˆ

> **å®Œæ•´çš„ç³»ç»Ÿé…ç½®é›†ä¸­ç®¡ç†è§£å†³æ–¹æ¡ˆ**

---

## ğŸ¯ **æ–¹æ¡ˆæ¦‚è¿°**

å°†ç³»ç»Ÿé…ç½®ï¼ˆé‚®ä»¶æœåŠ¡ã€ç¬¬ä¸‰æ–¹ç™»å½•ã€ç”¨æˆ·ç®¡ç†ç­‰ï¼‰ä»ç¡¬ç¼–ç ç¯å¢ƒå˜é‡è¿ç§»åˆ°Strapiåå°å¯è§†åŒ–ç®¡ç†ï¼Œå®ç°ï¼š

### **æ ¸å¿ƒä¼˜åŠ¿**
- âœ… **æ— éœ€æ”¹ä»£ç **ï¼šé…ç½®å˜æ›´é€šè¿‡åå°ç•Œé¢å®Œæˆ
- âœ… **å®æ—¶ç”Ÿæ•ˆ**ï¼šé…ç½®ä¿®æ”¹åå‰ç«¯è‡ªåŠ¨è·å–æœ€æ–°è®¾ç½®
- âœ… **å®‰å…¨åˆ†ç¦»**ï¼šæ•æ„Ÿä¿¡æ¯ä»ç”¨ç¯å¢ƒå˜é‡ï¼Œä¸šåŠ¡é…ç½®ç”¨æ•°æ®åº“
- âœ… **æƒé™æ§åˆ¶**ï¼šç®¡ç†å‘˜æ‰èƒ½è®¿é—®å®Œæ•´é…ç½®ï¼Œå‰ç«¯åªè·å–å…¬å¼€é…ç½®
- âœ… **ç±»å‹å®‰å…¨**ï¼šå®Œæ•´çš„TypeScriptç±»å‹å®šä¹‰å’ŒéªŒè¯

---

## ğŸ“‹ **ç³»ç»Ÿé…ç½®å†…å®¹ç±»å‹è®¾è®¡**

### **åŸºç¡€ä¿¡æ¯**
- **å†…å®¹ç±»å‹**: `system-config` (singleType)
- **é›†åˆåç§°**: `system_configs`
- **æƒé™ç­–ç•¥**: å…¬å¼€ç«¯ç‚¹æ— éœ€è®¤è¯ï¼Œç®¡ç†ç«¯ç‚¹éœ€è¦æƒé™

### **é…ç½®åˆ†ç±»**

#### **1. é‚®ä»¶æœåŠ¡é…ç½®**
```typescript
emailServiceEnabled: boolean          // é‚®ä»¶æœåŠ¡æ€»å¼€å…³
emailServiceProvider: enum            // æœåŠ¡å•†ï¼šgmail/sendgrid/aliyunç­‰
emailSmtpHost: string                 // SMTPæœåŠ¡å™¨åœ°å€
emailSmtpPort: number                 // SMTPç«¯å£
emailFromAddress: email               // å‘ä»¶äººé‚®ç®±
emailFromName: string                 // å‘ä»¶äººå§“å
emailUseTLS: boolean                  // ä½¿ç”¨TLSåŠ å¯†
emailSubjectPrefix: string            // é‚®ä»¶ä¸»é¢˜å‰ç¼€
```

#### **2. ç”¨æˆ·æ³¨å†Œé…ç½®**
```typescript
registrationEnabled: boolean         // æ³¨å†ŒåŠŸèƒ½å¼€å…³
emailVerificationEnabled: boolean    // é‚®ç®±éªŒè¯å¼€å…³
emailVerificationCodeLength: number  // éªŒè¯ç é•¿åº¦(4-8ä½)
emailVerificationCodeExpiry: number  // éªŒè¯ç æœ‰æ•ˆæœŸ(ç§’)
passwordResetEnabled: boolean        // å¯†ç é‡ç½®å¼€å…³
passwordResetTokenExpiry: number     // é‡ç½®ä»¤ç‰Œæœ‰æ•ˆæœŸ(ç§’)
```

#### **3. å¯†ç ç­–ç•¥é…ç½®**
```typescript
passwordMinLength: number            // æœ€å°é•¿åº¦(6-20ä½)
passwordRequireSpecialChar: boolean  // ç‰¹æ®Šå­—ç¬¦è¦æ±‚
passwordRequireNumber: boolean       // æ•°å­—è¦æ±‚
passwordRequireUppercase: boolean    // å¤§å†™å­—æ¯è¦æ±‚
```

#### **4. OAuthç™»å½•é…ç½®**
```typescript
oauthEnabled: boolean                // OAuthæ€»å¼€å…³
githubOauthEnabled: boolean          // GitHubç™»å½•å¼€å…³
googleOauthEnabled: boolean          // Googleç™»å½•å¼€å…³
wechatOauthEnabled: boolean          // å¾®ä¿¡ç™»å½•å¼€å…³
qqOauthEnabled: boolean              // QQç™»å½•å¼€å…³
oauthAutoRegister: boolean           // OAuthè‡ªåŠ¨æ³¨å†Œ
```

#### **5. å®‰å…¨å’Œä¼šè¯é…ç½®**
```typescript
sessionTimeout: number              // ä¼šè¯è¶…æ—¶æ—¶é—´(ç§’)
maxLoginAttempts: number             // æœ€å¤§ç™»å½•å°è¯•æ¬¡æ•°
accountLockoutDuration: number       // è´¦å·é”å®šæ—¶é•¿(ç§’)
allowedEmailDomains: text            // å…è®¸çš„é‚®ç®±åŸŸåç™½åå•
blockedEmailDomains: text            // ç¦æ­¢çš„é‚®ç®±åŸŸåé»‘åå•
```

#### **6. ç³»ç»Ÿç»´æŠ¤é…ç½®**
```typescript
maintenanceMode: boolean             // ç»´æŠ¤æ¨¡å¼å¼€å…³
maintenanceMessage: text             // ç»´æŠ¤æç¤ºä¿¡æ¯
systemNotificationEmail: email      // ç³»ç»Ÿé€šçŸ¥é‚®ç®±
```

#### **7. ç”¨æˆ·åŠŸèƒ½é…ç½®**
```typescript
enableUserProfileEdit: boolean      // ç”¨æˆ·èµ„æ–™ç¼–è¾‘æƒé™
enableAccountDeletion: boolean      // è´¦å·åˆ é™¤åŠŸèƒ½
defaultUserRole: string             // é»˜è®¤ç”¨æˆ·è§’è‰²
```

---

## ğŸ”§ **APIç«¯ç‚¹è®¾è®¡**

### **å…¬å¼€ç«¯ç‚¹ï¼ˆå‰ç«¯å¯ç”¨ï¼‰**
```http
GET /api/system-config/public
```
**è¿”å›**: ä»…åŒ…å«å‰ç«¯éœ€è¦çš„å…¬å¼€é…ç½®ï¼Œä¸åŒ…å«æ•æ„Ÿä¿¡æ¯

**å“åº”ç¤ºä¾‹**:
```json
{
  "registrationEnabled": true,
  "emailVerificationEnabled": true,
  "oauthEnabled": true,
  "githubOauthEnabled": true,
  "passwordMinLength": 8,
  "passwordRequireSpecialChar": true,
  "maintenanceMode": false,
  "maintenanceMessage": "ç½‘ç«™ç»´æŠ¤ä¸­..."
}
```

### **ç®¡ç†ç«¯ç‚¹ï¼ˆéœ€è¦æƒé™ï¼‰**
```http
GET /api/system-config          # è·å–å®Œæ•´é…ç½®
PUT /api/system-config          # æ›´æ–°é…ç½®
GET /api/system-config/email    # è·å–é‚®ä»¶é…ç½®
```

---

## ğŸ’» **å‰ç«¯é›†æˆæ–¹æ¡ˆ**

### **APIå®¢æˆ·ç«¯å‡½æ•°**
```typescript
// åŸºç¡€APIå‡½æ•°
getPublicSystemConfig(): Promise<PublicSystemConfig>
getFullSystemConfig(): Promise<StrapiSystemConfig>
updateSystemConfig(data): Promise<boolean>
getEmailServiceConfig(): Promise<EmailConfig>

// ä¾¿æ·å‡½æ•°
validatePassword(password: string): Promise<{isValid: boolean, errors: string[]}>
getEnabledOAuthProviders(): Promise<string[]>
isMaintenanceMode(): Promise<boolean>
```

### **React Hooks**
```typescript
// åŸºç¡€é…ç½®Hook
useSystemConfig()                    // è·å–ç³»ç»Ÿé…ç½®
useOAuthProviders()                  // è·å–å¯ç”¨çš„OAuthæä¾›å•†
usePasswordValidation()              // å¯†ç éªŒè¯
useMaintenanceMode()                 // ç»´æŠ¤æ¨¡å¼æ£€æŸ¥

// åŠŸèƒ½ä¸“ç”¨Hooks
useRegistrationAvailability()        // æ³¨å†ŒåŠŸèƒ½å¯ç”¨æ€§
useOAuthAvailability()               // OAuthåŠŸèƒ½å¯ç”¨æ€§
useUserPermissions()                 // ç”¨æˆ·æƒé™æ£€æŸ¥
usePasswordPolicy()                  // å¯†ç ç­–ç•¥
useSystemStatus()                    // ç³»ç»ŸçŠ¶æ€ç»¼åˆ
```

### **ä½¿ç”¨ç¤ºä¾‹**
```typescript
// åœ¨æ³¨å†Œè¡¨å•ä¸­ä½¿ç”¨åŠ¨æ€å¯†ç ç­–ç•¥
function RegisterForm() {
  const { minLength, requireSpecialChar, getPolicyDescription } = usePasswordPolicy()
  const { validatePassword, validationResult } = usePasswordValidation()
  
  // ç»„ä»¶é€»è¾‘...
}

// åœ¨ç™»å½•å¼¹çª—ä¸­æ ¹æ®é…ç½®æ˜¾ç¤ºOAuthé€‰é¡¹
function LoginModal() {
  const { isOAuthEnabled, isGitHubEnabled } = useOAuthAvailability()
  
  return (
    <>
      {isOAuthEnabled && isGitHubEnabled && (
        <GitHubLoginButton />
      )}
    </>
  )
}
```

---

## ğŸ”’ **å®‰å…¨ç­–ç•¥**

### **æ•æ„Ÿä¿¡æ¯å¤„ç†**
```bash
# ç¯å¢ƒå˜é‡ï¼ˆæ•æ„Ÿä¿¡æ¯ï¼‰
EMAIL_SERVER_USER=your-smtp-username      # SMTPç”¨æˆ·å
EMAIL_SERVER_PASSWORD=your-smtp-password  # SMTPå¯†ç 
GITHUB_CLIENT_SECRET=your-secret           # OAuthå¯†é’¥

# æ•°æ®åº“é…ç½®ï¼ˆéæ•æ„Ÿä¿¡æ¯ï¼‰
emailSmtpHost=smtp.gmail.com              # SMTPæœåŠ¡å™¨
emailSmtpPort=587                         # SMTPç«¯å£
emailFromAddress=noreply@domain.com       # å‘ä»¶äººåœ°å€
```

### **æƒé™æ§åˆ¶**
- **å…¬å¼€ç«¯ç‚¹**: æ— éœ€è®¤è¯ï¼Œè¿”å›å‰ç«¯éœ€è¦çš„é…ç½®
- **ç®¡ç†ç«¯ç‚¹**: éœ€è¦ç®¡ç†å‘˜æƒé™ï¼Œè¿”å›å®Œæ•´é…ç½®
- **æ›´æ–°æ“ä½œ**: ä»…ç®¡ç†å‘˜å¯ä»¥ä¿®æ”¹é…ç½®
- **å®¡è®¡æ—¥å¿—**: è®°å½•é…ç½®ä¿®æ”¹äººå’Œæ—¶é—´

---

## ğŸ“Š **é…ç½®ç®¡ç†ç•Œé¢**

### **Strapiåå°ç•Œé¢**
1. **å†…å®¹ç®¡ç†** â†’ **ç³»ç»Ÿé…ç½®** â†’ **ç¼–è¾‘**
2. **åˆ†ç»„æ˜¾ç¤º**: é‚®ä»¶é…ç½®ã€ç”¨æˆ·ç®¡ç†ã€å®‰å…¨è®¾ç½®ç­‰
3. **å­—æ®µæè¿°**: æ¯ä¸ªé…ç½®é¡¹éƒ½æœ‰è¯¦ç»†çš„ä¸­æ–‡è¯´æ˜
4. **éªŒè¯è§„åˆ™**: æ•°å­—èŒƒå›´ã€å¿…å¡«å­—æ®µã€é‚®ç®±æ ¼å¼ç­‰

### **é…ç½®é¡¹è¯´æ˜**
- æ¯ä¸ªå­—æ®µéƒ½æœ‰ä¸­æ–‡æè¿°å’Œä½¿ç”¨è¯´æ˜
- å…³é”®é…ç½®é¡¹åŒ…å«ç¤ºä¾‹å€¼å’Œæ ¼å¼è¦æ±‚
- å®‰å…¨ç›¸å…³é…ç½®æœ‰é£é™©æç¤º
- ä¿®æ”¹å†å²è®°å½•ä¾¿äºå›æ»š

---

## ğŸš€ **éƒ¨ç½²å’Œåˆå§‹åŒ–**

### **è‡ªåŠ¨åˆå§‹åŒ–**
ç³»ç»Ÿå¯åŠ¨æ—¶è‡ªåŠ¨ï¼š
1. åˆ›å»ºé»˜è®¤ç³»ç»Ÿé…ç½®
2. é…ç½®Publicè§’è‰²æƒé™
3. éªŒè¯APIç«¯ç‚¹å¯ç”¨æ€§
4. è¾“å‡ºé…ç½®çŠ¶æ€æŠ¥å‘Š

### **æƒé™é…ç½®**
```javascript
// bootstrapå‡½æ•°è‡ªåŠ¨é…ç½®
{ action: 'find', subject: 'api::system-config.system-config' }
{ action: 'getPublicConfig', subject: 'api::system-config.system-config' }
```

### **åˆå§‹é…ç½®**
```json
{
  "emailServiceEnabled": true,
  "emailServiceProvider": "gmail",
  "registrationEnabled": true,
  "emailVerificationEnabled": true,
  "oauthEnabled": true,
  "githubOauthEnabled": true,
  "passwordMinLength": 8,
  "passwordRequireSpecialChar": true,
  "passwordRequireNumber": true,
  "maintenanceMode": false
}
```

---

## ğŸ“ **ä½¿ç”¨æµç¨‹**

### **å¼€å‘é˜¶æ®µ**
1. **é…ç½®ç¯å¢ƒå˜é‡**: è®¾ç½®æ•æ„Ÿä¿¡æ¯ï¼ˆSMTPå¯†ç ã€OAuthå¯†é’¥ç­‰ï¼‰
2. **è®¿é—®åå°**: http://localhost:1337/admin â†’ ç³»ç»Ÿé…ç½®
3. **è°ƒæ•´è®¾ç½®**: æ ¹æ®éœ€æ±‚ä¿®æ”¹é‚®ä»¶æœåŠ¡å•†ã€å¯†ç ç­–ç•¥ç­‰
4. **å‰ç«¯è‡ªåŠ¨åŒæ­¥**: æ— éœ€é‡å¯ï¼Œé…ç½®å®æ—¶ç”Ÿæ•ˆ

### **ç”Ÿäº§ç¯å¢ƒ**
1. **ç¯å¢ƒå˜é‡é…ç½®**: ç”Ÿäº§ç¯å¢ƒçš„SMTPå’ŒOAuthé…ç½®
2. **åå°ç²¾ç»†è°ƒæ•´**: æ³¨å†Œå¼€å…³ã€å¯†ç ç­–ç•¥ã€ç»´æŠ¤æ¨¡å¼ç­‰
3. **è¿è¥å“åº”**: å¿«é€Ÿå¼€å¯ç»´æŠ¤æ¨¡å¼ã€è°ƒæ•´å®‰å…¨ç­–ç•¥
4. **æ— ä»£ç éƒ¨ç½²**: é…ç½®å˜æ›´æ— éœ€é‡æ–°éƒ¨ç½²ä»£ç 

---

## âœ… **éªŒè¯æµ‹è¯•**

### **APIç«¯ç‚¹æµ‹è¯•**
```bash
# æµ‹è¯•å…¬å¼€é…ç½®ç«¯ç‚¹
curl http://localhost:1337/api/system-config/public

# æµ‹è¯•é…ç½®æ˜¯å¦ç”Ÿæ•ˆ
curl http://localhost:3000/api/test-system-config
```

### **åŠŸèƒ½éªŒè¯**
- âœ… æ³¨å†Œè¡¨å•å¯†ç éªŒè¯ä½¿ç”¨åŠ¨æ€ç­–ç•¥
- âœ… ç™»å½•å¼¹çª—æ ¹æ®é…ç½®æ˜¾ç¤ºOAuthé€‰é¡¹
- âœ… ç»´æŠ¤æ¨¡å¼æ—¶å‰ç«¯æ˜¾ç¤ºç»´æŠ¤é¡µé¢
- âœ… é‚®ä»¶æœåŠ¡é…ç½®å½±å“éªŒè¯ç å‘é€
- âœ… æƒé™é…ç½®æ§åˆ¶ç”¨æˆ·åŠŸèƒ½å¯è§æ€§

---

## ğŸ‰ **æ–¹æ¡ˆä¼˜åŠ¿æ€»ç»“**

### **æŠ€æœ¯ä¼˜åŠ¿**
- **é›†ä¸­ç®¡ç†**: æ‰€æœ‰ç³»ç»Ÿé…ç½®ç»Ÿä¸€ç®¡ç†
- **ç±»å‹å®‰å…¨**: å®Œæ•´TypeScriptç±»å‹æ”¯æŒ
- **ç¼“å­˜ä¼˜åŒ–**: APIå“åº”è‡ªåŠ¨ç¼“å­˜ï¼Œæ€§èƒ½ä¼˜è‰¯
- **é”™è¯¯å¤„ç†**: å®Œå–„çš„é”™è¯¯å¤„ç†å’Œé™çº§ç­–ç•¥

### **ä¸šåŠ¡ä¼˜åŠ¿**
- **è¿è¥æ•ˆç‡**: é…ç½®å˜æ›´æ— éœ€æŠ€æœ¯ä»‹å…¥
- **å¿«é€Ÿå“åº”**: ç´§æ€¥æƒ…å†µä¸‹å¿«é€Ÿè°ƒæ•´
- **ç”¨æˆ·ä½“éªŒ**: æ ¹æ®é…ç½®åŠ¨æ€è°ƒæ•´ç•Œé¢
- **å®‰å…¨åˆè§„**: æ•æ„Ÿä¿¡æ¯å’Œä¸šåŠ¡é…ç½®åˆ†ç¦»

### **ç»´æŠ¤ä¼˜åŠ¿**
- **ç‰ˆæœ¬æ§åˆ¶**: é…ç½®å˜æ›´æœ‰å†å²è®°å½•
- **æƒé™æ§åˆ¶**: ä¸¥æ ¼çš„è®¿é—®æƒé™ç®¡ç†
- **æ–‡æ¡£å®Œæ•´**: æ¯ä¸ªé…ç½®é¡¹éƒ½æœ‰è¯¦ç»†è¯´æ˜
- **æ‰©å±•æ€§å¼º**: æ˜“äºæ·»åŠ æ–°çš„é…ç½®é¡¹

---

## ğŸ“š **ç›¸å…³æ–‡æ¡£**

- [é‚®ä»¶æœåŠ¡é…ç½®æŒ‡å—](./é‚®ä»¶æœåŠ¡é…ç½®æŒ‡å—.md)
- [GitHub OAuthé…ç½®æŒ‡å—](./GitHub_OAuthé…ç½®æŒ‡å—.md)
- [ç”¨æˆ·è®¤è¯ç³»ç»Ÿæ–‡æ¡£](../ç”¨æˆ·è®¤è¯/)
- [Strapiå†…å®¹ç±»å‹å¼€å‘æŒ‡å—](../../åå°ç³»ç»Ÿ/Strapiå­—æ®µæè¿°é…ç½®æŒ‡å—.md)

---

**æœ€åæ›´æ–°**: 2025å¹´7æœˆ31æ—¥  
**ç‰ˆæœ¬**: v1.0  
**çŠ¶æ€**: âœ… å·²å®Œæˆå¹¶æµ‹è¯•