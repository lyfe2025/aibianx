# æ•°æ®åº“é…ç½®ä¿®æ­£æŠ¥å‘Š

## ğŸ¯ é—®é¢˜èƒŒæ™¯

ç”¨æˆ·æŒ‡å‡ºé¡¹ç›®çš„å®é™…æ•°æ®åº“é…ç½®ä¸ºï¼š
- **æ•°æ®åº“å**ï¼š`aibianx_dev` (è€Œéä¹‹å‰è®¾ç½®çš„ `aibianx`)
- **ç”¨æˆ·å**ï¼š`aibianx_dev` (è€Œéä¹‹å‰è®¾ç½®çš„ `aibianx_user`)  
- **å¯†ç **ï¼šç©ºå¯†ç  (è€Œéä¹‹å‰è®¾ç½®çš„ `aibianx_password`)

éœ€è¦å°†æ‰€æœ‰ç›¸å…³é…ç½®æ–‡ä»¶å’Œè„šæœ¬æ›´æ–°ä¸ºç”¨æˆ·çš„å®é™…é…ç½®ã€‚

## ğŸ” å½±å“èŒƒå›´

### éœ€è¦ä¿®æ­£çš„æ–‡ä»¶å’Œè„šæœ¬

1. **åç«¯é…ç½®**ï¼š`backend/.env`
2. **å¯åŠ¨è„šæœ¬**ï¼š`start-dev.sh`
3. **æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬**ï¼š`scripts/init-database.sh`
4. **PostgreSQLæ•°æ®åº“**ï¼šç”¨æˆ·å’Œæ•°æ®åº“å¯¹è±¡

## âœ… ä¿®æ­£æ‰§è¡Œ

### 1. PostgreSQLæ•°æ®åº“é…ç½®

**åˆ›å»ºæ­£ç¡®çš„ç”¨æˆ·å’Œæ•°æ®åº“**ï¼š
```bash
# æ£€æŸ¥ç”¨æˆ·å­˜åœ¨
âœ… ç”¨æˆ· aibianx_dev å·²å­˜åœ¨

# åˆ›å»ºæ•°æ®åº“å¹¶æˆæƒ
CREATE DATABASE aibianx_dev OWNER aibianx_dev;
GRANT ALL PRIVILEGES ON DATABASE aibianx_dev TO aibianx_dev;
```

**è¿æ¥æµ‹è¯•**ï¼š
```bash
psql -h localhost -U aibianx_dev -d aibianx_dev -c "SELECT current_database(), current_user;"
# âœ… è¿”å›: aibianx_dev | aibianx_dev
```

### 2. åç«¯ç¯å¢ƒå˜é‡æ›´æ–°

**ä¿®æ­£ `backend/.env`**ï¼š
```bash
# æ•°æ®åº“é…ç½®
DATABASE_CLIENT=postgres
DATABASE_HOST=localhost
DATABASE_PORT=5432
DATABASE_NAME=aibianx_dev        # âœ… ä¿®æ­£
DATABASE_USERNAME=aibianx_dev    # âœ… ä¿®æ­£  
DATABASE_PASSWORD=               # âœ… ä¿®æ­£ (ç©ºå¯†ç )
```

### 3. å¯åŠ¨è„šæœ¬æ›´æ–°

**ä¿®æ­£ `start-dev.sh` ä¸­çš„æ•°æ®åº“æ£€æŸ¥é€»è¾‘**ï¼š

```bash
# ç”¨æˆ·æ£€æŸ¥å’Œåˆ›å»º
if ! psql postgres -c "SELECT 1 FROM pg_roles WHERE rolname = 'aibianx_dev'" | grep -q "1"; then
    echo "ğŸ”„ åˆ›å»ºæ•°æ®åº“ç”¨æˆ·..."
    psql postgres -c "CREATE USER aibianx_dev;" > /dev/null 2>&1
fi

# æ•°æ®åº“æ£€æŸ¥å’Œåˆ›å»º
if ! psql postgres -c "SELECT 1 FROM pg_database WHERE datname = 'aibianx_dev'" | grep -q "1"; then
    echo "ğŸ”„ åˆ›å»ºæ•°æ®åº“..."
    psql postgres -c "CREATE DATABASE aibianx_dev OWNER aibianx_dev;" > /dev/null 2>&1
    psql postgres -c "GRANT ALL PRIVILEGES ON DATABASE aibianx_dev TO aibianx_dev;" > /dev/null 2>&1
fi
```

**æ›´æ–°çŠ¶æ€æ˜¾ç¤º**ï¼š
```bash
echo "   âœ… PostgreSQL: å·²è¿æ¥ (æ•°æ®åº“: aibianx_dev, ç”¨æˆ·: aibianx_dev)"
```

**æ›´æ–°ç®¡ç†å‘½ä»¤æç¤º**ï¼š
```bash
echo "   - æŸ¥çœ‹PostgreSQLæ•°æ®åº“: psql aibianx_dev -U aibianx_dev"
echo "   - é‡ç½®PostgreSQL: psql postgres -c \"DROP DATABASE IF EXISTS aibianx_dev; CREATE DATABASE aibianx_dev OWNER aibianx_dev;\""
```

### 4. æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬æ›´æ–°

**ä¿®æ­£ `scripts/init-database.sh`**ï¼š

```bash
# é…ç½®æ›´æ–°
DATABASE_NAME="aibianx_dev"
DATABASE_USER="aibianx_dev"  
DATABASE_PASSWORD=""

# ç”¨æˆ·åˆ›å»ºï¼ˆæ— å¯†ç ï¼‰
psql postgres -c "CREATE USER $DATABASE_USER;"

# è¿æ¥æµ‹è¯•ï¼ˆæ— å¯†ç ï¼‰
psql -h localhost -U $DATABASE_USER -d $DATABASE_NAME -c "SELECT current_database(), current_user;"

# è¿æ¥ä¿¡æ¯æ˜¾ç¤º
echo "   å¯†ç : (æ— å¯†ç )"
echo "   psql -h localhost -U $DATABASE_USER -d $DATABASE_NAME"
```

## ğŸ‰ éªŒè¯ç»“æœ

### 1. å¯åŠ¨æµ‹è¯•

**å¼€å‘ç¯å¢ƒå¯åŠ¨æˆåŠŸ**ï¼š
```bash
ğŸ‰ å¼€å‘ç¯å¢ƒå¯åŠ¨å®Œæˆï¼
ğŸ—„ï¸  æ•°æ®åº“çŠ¶æ€ï¼š
   âœ… PostgreSQL: å·²è¿æ¥ (æ•°æ®åº“: aibianx_dev, ç”¨æˆ·: aibianx_dev)
```

### 2. åŠŸèƒ½éªŒè¯

**åç«¯APIæ­£å¸¸**ï¼š
```bash
curl http://localhost:1337/api/articles
# âœ… è¿”å›: 8ç¯‡æ–‡ç« æ•°æ®ï¼Œåˆ†é¡µä¿¡æ¯æ­£å¸¸
```

**å‰ç«¯OAuthé…ç½®æ­£å¸¸**ï¼š
```bash
curl http://localhost:3000/api/auth/providers  
# âœ… è¿”å›: credentials provideré…ç½®
```

**æ•°æ®åº“è¿æ¥æ­£å¸¸**ï¼š
```bash
psql -h localhost -U aibianx_dev -d aibianx_dev -c "SELECT current_database(), current_user;"
# âœ… è¿”å›: aibianx_dev | aibianx_dev
```

## ğŸ“Š ä¿®æ­£å‰åå¯¹æ¯”

| é…ç½®é¡¹ | ä¿®æ­£å‰ | ä¿®æ­£å |
|--------|--------|--------|
| æ•°æ®åº“å | `aibianx` | `aibianx_dev` âœ… |
| ç”¨æˆ·å | `aibianx_user` | `aibianx_dev` âœ… |
| å¯†ç  | `aibianx_password` | `""` (ç©º) âœ… |
| è¿æ¥æ–¹å¼ | `PGPASSWORD=xxx psql` | `psql` (æ— å¯†ç ) âœ… |

## ğŸ”§ æŠ€æœ¯è¦ç‚¹

### 1. æ— å¯†ç PostgreSQLç”¨æˆ·

- **åˆ›å»ºè¯­æ³•**ï¼š`CREATE USER username;` (ä¸æŒ‡å®šå¯†ç )
- **è¿æ¥æ–¹å¼**ï¼š`psql -U username -d database` (æ— éœ€PGPASSWORD)
- **å®‰å…¨è€ƒè™‘**ï¼šé€‚ç”¨äºæœ¬åœ°å¼€å‘ç¯å¢ƒï¼Œä¾èµ–ç³»ç»Ÿç”¨æˆ·èº«ä»½éªŒè¯

### 2. ç¯å¢ƒå˜é‡å¤„ç†

- **ç©ºå¯†ç è®¾ç½®**ï¼š`DATABASE_PASSWORD=` (ç­‰å·åä¸ºç©º)
- **Strapiè¯»å–**ï¼šæ­£ç¡®å¤„ç†ç©ºå­—ç¬¦ä¸²å¯†ç é…ç½®
- **å‘åå…¼å®¹**ï¼šä¿æŒé…ç½®æ–‡ä»¶ç»“æ„å®Œæ•´æ€§

### 3. è„šæœ¬å¥å£®æ€§

- **ç”¨æˆ·å­˜åœ¨æ£€æŸ¥**ï¼šé¿å…é‡å¤åˆ›å»ºç”¨æˆ·é”™è¯¯
- **æ•°æ®åº“å­˜åœ¨æ£€æŸ¥**ï¼šé˜²æ­¢é‡å¤åˆ›å»ºæ•°æ®åº“
- **æ— å¯†ç é€‚é…**ï¼šç§»é™¤æ‰€æœ‰PGPASSWORDç›¸å…³ä»£ç 

## ğŸ“‹ ç»´æŠ¤æŒ‡å—

### 1. æ•°æ®åº“è¿æ¥

```bash
# è¿æ¥æ•°æ®åº“
psql -h localhost -U aibianx_dev -d aibianx_dev

# æŸ¥çœ‹è¡¨åˆ—è¡¨
\dt

# é€€å‡º
\q
```

### 2. é‡ç½®æ•°æ®åº“

```bash
# åˆ é™¤å¹¶é‡æ–°åˆ›å»º
psql postgres -c "DROP DATABASE IF EXISTS aibianx_dev;"
psql postgres -c "CREATE DATABASE aibianx_dev OWNER aibianx_dev;"
```

### 3. å¤‡ä»½å’Œæ¢å¤

```bash
# å¤‡ä»½
pg_dump -h localhost -U aibianx_dev aibianx_dev > backup.sql

# æ¢å¤  
psql -h localhost -U aibianx_dev aibianx_dev < backup.sql
```

## ğŸ¯ æ€»ç»“

**ä¿®æ­£æˆæœ**ï¼š
- âœ… æ•°æ®åº“é…ç½®ä¸ç”¨æˆ·å®é™…ç¯å¢ƒå®Œå…¨ä¸€è‡´
- âœ… æ‰€æœ‰è„šæœ¬å’Œé…ç½®æ–‡ä»¶å·²åŒæ­¥æ›´æ–°
- âœ… å¼€å‘ç¯å¢ƒå¯åŠ¨æ­£å¸¸ï¼ŒåŠŸèƒ½éªŒè¯é€šè¿‡
- âœ… ä¿æŒäº†ç³»ç»Ÿçš„å®Œæ•´æ€§å’Œç¨³å®šæ€§

**ç”¨æˆ·ä½“éªŒ**ï¼š
- ğŸš€ ä½¿ç”¨ç”¨æˆ·ç†Ÿæ‚‰çš„æ•°æ®åº“é…ç½®
- ğŸ” æ— éœ€é‡æ–°å­¦ä¹ æˆ–é€‚åº”æ–°çš„è¿æ¥æ–¹å¼
- ğŸ“Š ä¿æŒäº†åŸæœ‰çš„æ•°æ®å’Œå¼€å‘æµç¨‹
- ğŸ› ï¸ æä¾›äº†å®Œæ•´çš„ç»´æŠ¤å’Œç®¡ç†æŒ‡å—

ç°åœ¨ç³»ç»Ÿä½¿ç”¨çš„æ˜¯ç”¨æˆ·æä¾›çš„æ­£ç¡®æ•°æ®åº“é…ç½®ï¼Œæ‰€æœ‰ç›¸å…³è„šæœ¬å’Œæ–‡æ¡£éƒ½å·²åŒæ­¥æ›´æ–°ï¼Œç¡®ä¿äº†é…ç½®çš„ä¸€è‡´æ€§å’Œå¼€å‘ç¯å¢ƒçš„ç¨³å®šæ€§ï¼