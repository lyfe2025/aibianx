# 🚀 AI变现之路 - 一键部署使用指南

## 📋 概述

本指南介绍如何使用AI变现之路的一键部署功能，让你在3分钟内完成从零到完整生产环境的部署。

## 🎯 一键部署命令

**只需要这一条命令：**

```bash
bash <(curl -s https://raw.githubusercontent.com/lyfe2025/aibianx/master/scripts/bootstrap.sh)
```

## 🔍 支持的系统

| 操作系统 | 版本 | 状态 | 注意事项 |
|----------|------|------|----------|
| Ubuntu | 18.04+ | ✅ 完全支持 | 推荐使用 |
| Debian | 10+ | ✅ 完全支持 | 自动安装依赖 |
| CentOS | 7+ | ✅ 完全支持 | 使用yum/dnf |
| RHEL | 7+ | ✅ 完全支持 | 企业级支持 |
| Fedora | 30+ | ✅ 完全支持 | 使用dnf |
| macOS | 10.15+ | ✅ 部分支持 | 需手动安装Docker Desktop |

## 📂 部署流程详解

### 🔧 阶段一：智能环境检测 (30秒)

脚本会自动执行以下检测：

```bash
✅ 系统信息检测
- 操作系统类型和版本
- 系统架构 (x86_64/arm64)
- 用户权限和sudo访问
- 磁盘空间检查 (需要至少2GB)
- 网络连接验证

✅ 现有环境评估  
- Docker安装状态
- Git工具检查
- 项目目录冲突检测
```

**用户交互**：
- 显示系统信息摘要
- 确认是否继续部署

### ⬇️ 阶段二：依赖自动安装 (1-2分钟)

根据检测结果自动安装缺失的依赖：

```bash
🔧 Docker安装 (如果缺失)
Ubuntu/Debian: apt update && apt install docker.io
CentOS/RHEL:   yum install docker 或 dnf install docker
macOS:         提示安装Docker Desktop

🔧 Docker Compose安装 (如果缺失)
Linux:  下载最新版本到 /usr/local/bin/
macOS:  Docker Desktop已包含

🔧 Git安装 (如果缺失)
所有系统: 使用包管理器自动安装

🔧 服务配置
- 启动Docker服务
- 添加用户到docker组
- 验证服务运行状态
```

**用户交互**：
- 可能需要输入sudo密码
- macOS用户需要手动安装Docker Desktop

### 📦 阶段三：项目代码获取 (30秒)

自动下载和配置项目：

```bash
📥 代码克隆
- 从GitHub克隆最新代码
- 目标位置: /opt/aibianx
- 处理目录冲突 (用户选择)

🔐 权限设置
- 设置文件所有者为当前用户
- 为脚本文件添加执行权限
- 创建全局快捷命令

🔗 快捷方式创建
- 创建 /usr/local/bin/aibianx 命令
- 添加到系统PATH
- 验证全局命令可用性
```

**用户交互**：
- 如果目录已存在，选择删除还是更新
- 确认安装位置

### 🎛️ 阶段四：交互式配置界面 (用户操作)

自动进入项目的智能配置向导：

```bash
🎯 智能配置向导启动
1. 🌐 环境选择 (开发/生产)
2. 🌍 域名配置
   - 网站域名 (如: yourdomain.com)
   - 邮件域名 (如: mail.yourdomain.com)
3. 🗄️ 数据库配置
   - 数据库名称和密码
   - 连接参数
4. 📧 邮件系统配置
   - SMTP设置
   - 邮件营销参数
5. 🔐 安全配置
   - JWT密钥生成
   - API Token配置
6. ⚙️ 高级设置
   - 环境变量检查
   - 服务端口配置
```

**用户操作**：
- 按提示配置各项参数
- 可使用默认值快速配置
- 支持后续修改

### 🚀 阶段五：服务启动 (在配置界面中)

通过交互界面启动服务：

```bash
🐳 Docker服务编排
1. 📦 镜像构建
   - 前端Next.js镜像
   - 后端Strapi镜像
2. 🗄️ 数据库启动
   - PostgreSQL数据库
   - Redis缓存
   - MeiliSearch搜索引擎
3. 📧 邮件系统启动
   - BillionMail核心服务
   - Postfix SMTP服务
   - Dovecot IMAP服务
   - Roundcube WebMail
4. 🌐 Web服务启动
   - Nginx反向代理
   - SSL证书配置
```

### ✅ 阶段六：验证完成

自动验证部署结果：

```bash
🔍 健康检查
- 所有容器运行状态
- API端点响应测试
- 数据库连接验证
- 邮件服务测试

📋 结果报告
- 访问地址清单
- 管理员账号信息
- 后续操作建议
```

## 🌐 部署完成后的访问地址

### 主要服务
- **网站首页**: `https://yourdomain.com`
- **管理后台**: `https://yourdomain.com/admin`
- **API文档**: `https://yourdomain.com/documentation`

### 邮件系统
- **BillionMail管理**: `https://yourdomain.com:8080/billion`
- **WebMail**: `https://yourdomain.com:8080/roundcube`

### 开发环境 (localhost)
- **网站首页**: `http://localhost`
- **管理后台**: `http://localhost:1337/admin`
- **邮件管理**: `http://localhost:8080/billion`

## 🛠️ 部署后管理

### 全局快捷命令

部署完成后，可以在任何位置使用：

```bash
# 进入管理界面
aibianx

# 直接执行特定功能
aibianx production status    # 检查生产状态
aibianx deploy start        # 启动开发环境
aibianx tools diagnose     # 系统诊断
aibianx backup full        # 完整备份
```

### 本地管理

也可以进入项目目录使用：

```bash
cd /opt/aibianx
./scripts.sh               # 交互式管理界面
```

## 🚨 常见问题

### Q1: 网络连接失败
```bash
❌ 错误: ping: github.com: Name or service not known
```
**解决方案**：
- 检查网络连接
- 确认DNS设置正确
- 检查防火墙设置

### Q2: 权限不足
```bash
❌ 错误: Permission denied
```
**解决方案**：
- 确保有sudo权限
- 检查用户组设置
- 重新运行脚本

### Q3: Docker服务启动失败
```bash
❌ 错误: Cannot connect to the Docker daemon
```
**解决方案**：
```bash
# 重启Docker服务
sudo systemctl restart docker

# 检查用户组
sudo usermod -aG docker $USER

# 重新登录或执行
newgrp docker
```

### Q4: 端口被占用
```bash
❌ 错误: Port 80 is already in use
```
**解决方案**：
- 检查占用端口的服务
- 停止冲突的服务
- 或修改配置使用其他端口

### Q5: 磁盘空间不足
```bash
❌ 错误: No space left on device
```
**解决方案**：
- 清理系统垃圾文件
- 确保至少有2GB可用空间
- 清理Docker缓存: `docker system prune -a`

## 🔧 高级配置

### 自定义安装位置

如果需要自定义安装位置，可以修改脚本中的变量：

```bash
# 下载脚本到本地
curl -s https://raw.githubusercontent.com/lyfe2025/aibianx/master/scripts/bootstrap.sh > bootstrap.sh

# 编辑安装路径
vim bootstrap.sh
# 修改: INSTALL_DIR="/your/custom/path"

# 执行部署
bash bootstrap.sh
```

### 离线部署

对于无法直接访问GitHub的环境：

```bash
# 1. 在有网络的机器上下载
git clone https://github.com/lyfe2025/aibianx.git
tar czf aibianx.tar.gz aibianx/

# 2. 传输到目标机器
scp aibianx.tar.gz user@target-server:~

# 3. 在目标机器上解压和部署
tar xzf aibianx.tar.gz
cd aibianx
./scripts.sh
```

## 📞 获取帮助

如果在部署过程中遇到问题：

1. **查看日志**：部署过程中的详细日志
2. **运行诊断**：`aibianx tools diagnose`
3. **查看文档**：[完整部署指南](生产部署完整指南.md)
4. **提交问题**：[GitHub Issues](https://github.com/lyfe2025/aibianx/issues)

## 🎉 成功标志

当看到以下信息时，说明部署成功：

```bash
🎉 恭喜！AI变现之路已成功准备就绪

🌐 网站前端: https://yourdomain.com
⚙️ 管理后台: https://yourdomain.com/admin  
📖 API文档: https://yourdomain.com/documentation
📧 邮件管理: https://yourdomain.com:8080/billion

💡 快捷命令: aibianx
```

现在你可以：
1. 访问网站首页查看效果
2. 登录管理后台配置内容
3. 使用邮件系统发送营销邮件
4. 通过API开发自定义功能

祝你使用愉快！🚀