# ğŸš€ AIå˜ç°ä¹‹è·¯ - ç”Ÿäº§éƒ¨ç½²å®Œæ•´æŒ‡å—

## ğŸ“‹ éƒ¨ç½²æ¦‚è¿°

æœ¬æŒ‡å—å°†å¸¦ä½ ä»é›¶å¼€å§‹å®ŒæˆAIå˜ç°ä¹‹è·¯é¡¹ç›®çš„å®Œæ•´ç”Ÿäº§éƒ¨ç½²ã€‚æˆ‘ä»¬çš„éƒ¨ç½²ç³»ç»Ÿé‡‡ç”¨Dockerå®¹å™¨åŒ–æ¶æ„ï¼Œæ”¯æŒå…¨è‡ªåŠ¨åŒ–éƒ¨ç½²å’Œæ™ºèƒ½ç¯å¢ƒç®¡ç†ã€‚

### ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

```mermaid
graph TB
    subgraph "ç”¨æˆ·è®¿é—®å±‚"
        A[ç”¨æˆ·] --> B[Nginxç½‘å…³]
    end
    
    subgraph "åº”ç”¨æœåŠ¡å±‚"
        B --> C[å‰ç«¯æœåŠ¡<br/>Next.js]
        B --> D[åç«¯æœåŠ¡<br/>Strapi]
    end
    
    subgraph "æ•°æ®æœåŠ¡å±‚"
        D --> E[PostgreSQL<br/>æ•°æ®åº“]
        D --> F[MeiliSearch<br/>æœç´¢å¼•æ“]
        D --> G[Redis<br/>ç¼“å­˜]
    end
    
    subgraph "é‚®ä»¶æœåŠ¡å±‚"
        B --> H[BillionMail<br/>é‚®ä»¶ç³»ç»Ÿ]
        H --> I[Postfix<br/>SMTP]
        H --> J[Dovecot<br/>IMAP/POP3]
        H --> K[Roundcube<br/>WebMail]
    end
```

## ğŸ¯ å¿«é€Ÿå¼€å§‹ (3åˆ†é’Ÿä¸€é”®éƒ¨ç½²)

### ğŸš€ æ–¹å¼ä¸€ï¼šçœŸæ­£çš„ä¸€é”®éƒ¨ç½² (å¼ºçƒˆæ¨è)

**ä¸€æ¡å‘½ä»¤å®Œæˆæ‰€æœ‰éƒ¨ç½²ï¼š**

```bash
bash <(curl -s https://raw.githubusercontent.com/lyfe2025/aibianx/master/scripts/bootstrap.sh)
```

**éƒ¨ç½²æµç¨‹å…¨è‡ªåŠ¨ï¼š**
1. âœ… **è‡ªåŠ¨æ£€æŸ¥ç¯å¢ƒ** - æ£€æµ‹ç³»ç»Ÿå¹¶å®‰è£…Dockerã€Gitç­‰ä¾èµ–
2. âœ… **è‡ªåŠ¨æ‹‰å–ä»£ç ** - ä»GitHubå…‹éš†æœ€æ–°é¡¹ç›®åˆ°`/opt/aibianx`
3. âœ… **è¿›å…¥ç®¡ç†ç•Œé¢** - è‡ªåŠ¨å¯åŠ¨äº¤äº’å¼é…ç½®ç•Œé¢
4. âœ… **æ™ºèƒ½é…ç½®å¼•å¯¼** - é…ç½®åŸŸåã€æ•°æ®åº“ã€ç¯å¢ƒå˜é‡ç­‰
5. âœ… **ä¸€é”®å¯åŠ¨æœåŠ¡** - å¯åŠ¨å®Œæ•´çš„ç”Ÿäº§ç¯å¢ƒ

**å…¨å±€å¿«æ·å‘½ä»¤ï¼š**
```bash
# éƒ¨ç½²å®Œæˆåï¼Œéšæ—¶éšåœ°ä½¿ç”¨
aibianx                    # è¿›å…¥ç®¡ç†ç•Œé¢
aibianx production status  # æ£€æŸ¥ç”Ÿäº§çŠ¶æ€
aibianx deploy start      # å¯åŠ¨å¼€å‘ç¯å¢ƒ
```

### ğŸ› ï¸ æ–¹å¼äºŒï¼šä¼ ç»Ÿæ‰‹åŠ¨éƒ¨ç½²

```bash
# æ‰‹åŠ¨å…‹éš†é¡¹ç›®
git clone https://github.com/lyfe2025/aibianx.git
cd aibianx

# è¿›å…¥äº¤äº’å¼ç®¡ç†ç•Œé¢
./scripts.sh

# ğŸ”§ ç”Ÿäº§ç¯å¢ƒèœå• (çº¢è‰²ä¸»é¢˜)
# ================================
# 1) å…¨è‡ªåŠ¨éƒ¨ç½² (å®‰è£…ç¯å¢ƒ+ä»£ç +é…ç½®+éƒ¨ç½²)
# 2) å¯åŠ¨å‰ç«¯æœåŠ¡
# 3) å¯åŠ¨åç«¯æœåŠ¡
# 4) åœæ­¢ç”Ÿäº§ç¯å¢ƒ
# 5) é‡å¯ç”Ÿäº§ç¯å¢ƒ
# 6) æ£€æŸ¥ç”Ÿäº§çŠ¶æ€
# ...æ›´å¤šé€‰é¡¹
```

### ğŸ¯ æ¨èéƒ¨ç½²æ–¹æ¡ˆå¯¹æ¯”

| æ–¹æ¡ˆ | é€‚ç”¨åœºæ™¯ | ä¼˜åŠ¿ | å‘½ä»¤å¤æ‚åº¦ |
|------|----------|------|------------|
| **ä¸€é”®éƒ¨ç½²** | ğŸ”¥ æ–°ç”¨æˆ·ã€å¿«é€Ÿè¯•ç”¨ | é›¶é…ç½®ã€è‡ªåŠ¨åŒ–ã€å…¨çƒå¯ç”¨ | â­ (1æ¡å‘½ä»¤) |
| ä¼ ç»Ÿéƒ¨ç½² | é«˜çº§ç”¨æˆ·ã€å®šåˆ¶éœ€æ±‚ | å®Œå…¨æ§åˆ¶ã€åˆ†æ­¥æ“ä½œ | â­â­â­ (å¤šæ­¥æ“ä½œ) |

## ğŸ“‚ ä¸€é”®éƒ¨ç½²è¿‡ç¨‹è¯¦è§£

### ğŸ”§ é˜¶æ®µä¸€ï¼šæ™ºèƒ½ç¯å¢ƒæ£€æµ‹ (30ç§’)
```bash
âœ… ç³»ç»Ÿæ£€æµ‹å’ŒåŸºç¡€ç¯å¢ƒè¯„ä¼°
1. è‡ªåŠ¨è¯†åˆ«æ“ä½œç³»ç»Ÿ (Ubuntu/CentOS/Debian/macOS)
2. æ£€æŸ¥ç½‘ç»œè¿æ¥å’ŒGitHubè®¿é—®
3. éªŒè¯ç£ç›˜ç©ºé—´å’Œç³»ç»Ÿæƒé™
4. è¯„ä¼°ç°æœ‰Docker/Gitå®‰è£…çŠ¶æ€
```

### â¬‡ï¸ é˜¶æ®µäºŒï¼šä¾èµ–è‡ªåŠ¨å®‰è£… (1-2åˆ†é’Ÿ)
```bash
âœ… åŸºç¡€ä¾èµ–æ™ºèƒ½å®‰è£…
1. è‡ªåŠ¨å®‰è£…Dockerå’ŒDocker Compose
2. è‡ªåŠ¨å®‰è£…Gitç‰ˆæœ¬æ§åˆ¶å·¥å…·
3. é…ç½®ç”¨æˆ·ç»„å’Œæƒé™
4. å¯åŠ¨å’ŒéªŒè¯DockeræœåŠ¡
```

### ğŸ“¦ é˜¶æ®µä¸‰ï¼šé¡¹ç›®ä»£ç è·å– (30ç§’)
```bash
âœ… é¡¹ç›®ä»£ç è‡ªåŠ¨åŒ–ç®¡ç†
1. å…‹éš†æœ€æ–°ä»£ç åˆ° /opt/aibianx
2. è®¾ç½®æ–‡ä»¶æƒé™å’Œæ‰€æœ‰è€…
3. åˆ›å»ºå…¨å±€å¿«æ·å‘½ä»¤ (aibianx)
4. éªŒè¯é¡¹ç›®å®Œæ•´æ€§
```

### ğŸ›ï¸ é˜¶æ®µå››ï¼šäº¤äº’å¼é…ç½®ç•Œé¢ (ç”¨æˆ·æ“ä½œ)
```bash
ğŸ¯ è¿›å…¥æ™ºèƒ½é…ç½®å‘å¯¼
1. ğŸŒ é…ç½®åŸŸå (ç”Ÿäº§/å¼€å‘ç¯å¢ƒ)
2. ğŸ—„ï¸ è®¾ç½®æ•°æ®åº“å‚æ•°å’Œå¯†ç 
3. ğŸ“§ é…ç½®é‚®ä»¶ç³»ç»Ÿå‚æ•°
4. ğŸ” ç”Ÿæˆå®‰å…¨å¯†é’¥å’ŒJWT
5. âš™ï¸ æ£€æŸ¥å’Œä¿®æ”¹ç¯å¢ƒå˜é‡
```

### ğŸš€ é˜¶æ®µäº”ï¼šæœåŠ¡ç¼–æ’å¯åŠ¨ (2-3åˆ†é’Ÿ)
```bash
âœ… DockeræœåŠ¡å…¨è‡ªåŠ¨å¯åŠ¨
1. æ„å»ºå‰ç«¯Next.jsé•œåƒ
2. æ„å»ºåç«¯Strapié•œåƒ
3. å¯åŠ¨PostgreSQLã€Redisã€MeiliSearch
4. å¯åŠ¨BillionMailé‚®ä»¶ç³»ç»Ÿ
5. é…ç½®Nginxç½‘å…³å’ŒSSLè¯ä¹¦
```

### âœ… é˜¶æ®µå…­ï¼šå¥åº·æ£€æŸ¥éªŒè¯ (30ç§’)
```bash
âœ… ç³»ç»Ÿå®Œæ•´æ€§è‡ªåŠ¨éªŒè¯
1. æ£€æŸ¥æ‰€æœ‰å®¹å™¨è¿è¡ŒçŠ¶æ€
2. éªŒè¯APIç«¯ç‚¹å“åº”
3. æµ‹è¯•æ•°æ®åº“è¿æ¥
4. ç¡®è®¤é‚®ä»¶ç³»ç»ŸçŠ¶æ€
5. ç”Ÿæˆè®¿é—®åœ°å€æ¸…å•
```

### ğŸ‰ éƒ¨ç½²å®Œæˆæ ‡å¿—
```bash
ğŸŒ ç½‘ç«™å‰ç«¯: https://yourdomain.com
âš™ï¸ ç®¡ç†åå°: https://yourdomain.com/admin
ğŸ“– APIæ–‡æ¡£: https://yourdomain.com/documentation
ğŸ“§ é‚®ä»¶ç®¡ç†: https://yourdomain.com:8080/billion
```

## ğŸ”§ æ ¸å¿ƒé…ç½®æ–‡ä»¶è¯´æ˜

### ç¯å¢ƒå˜é‡é…ç½®
- **å‰ç«¯é…ç½®**: `frontend/.env.local`
- **åç«¯é…ç½®**: `backend/.env`
- **Dockeré…ç½®**: `deployment/docker-compose.unified.yml`

### è‡ªåŠ¨é…ç½®è„šæœ¬
- **ç»Ÿä¸€é…ç½®ç®¡ç†**: `deployment/configure-unified-env.sh`
- **è‡ªåŠ¨éƒ¨ç½²**: `scripts/production/auto-deploy.sh`
- **æœåŠ¡ç®¡ç†**: `scripts.sh`

## ğŸŒ è®¿é—®åœ°å€å’Œç«¯å£

### å¯¹å¤–æœåŠ¡ç«¯å£
| æœåŠ¡ | ç«¯å£ | è®¿é—®åœ°å€ | è¯´æ˜ |
|------|------|----------|------|
| ç½‘ç«™å‰ç«¯ | 80/443 | `https://yourdomain.com` | ä¸»è¦ç½‘ç«™ |
| åå°ç®¡ç† | 80/443 | `https://yourdomain.com/admin` | Strapiç®¡ç†åå° |
| APIæ–‡æ¡£ | 80/443 | `https://yourdomain.com/documentation` | æ¥å£æ–‡æ¡£ |
| é‚®ä»¶ç®¡ç† | 8080 | `https://yourdomain.com:8080/billion` | BillionMailç®¡ç† |
| WebMail | 8080 | `https://yourdomain.com:8080/roundcube` | ç½‘é¡µé‚®ç®± |

### é‚®ä»¶æœåŠ¡ç«¯å£
| åè®® | ç«¯å£ | åŠ å¯† | è¯´æ˜ |
|------|------|------|------|
| SMTP | 25 | æ—  | æœåŠ¡å™¨é—´é‚®ä»¶ä¼ è¾“ |
| SMTP | 587 | STARTTLS | é‚®ä»¶å®¢æˆ·ç«¯å‘é€ |
| SMTP | 465 | SSL/TLS | å®‰å…¨é‚®ä»¶å‘é€ |
| IMAP | 143 | æ—  | é‚®ä»¶å®¢æˆ·ç«¯æ¥æ”¶ |
| IMAP | 993 | SSL/TLS | å®‰å…¨é‚®ä»¶æ¥æ”¶ |
| POP3 | 110 | æ—  | é‚®ä»¶ä¸‹è½½ |
| POP3 | 995 | SSL/TLS | å®‰å…¨é‚®ä»¶ä¸‹è½½ |

## ğŸ› ï¸ ç®¡ç†å’Œç›‘æ§

### æœåŠ¡çŠ¶æ€æ£€æŸ¥
```bash
# æ£€æŸ¥æ‰€æœ‰æœåŠ¡çŠ¶æ€
./scripts.sh production status

# æŸ¥çœ‹æœåŠ¡æ—¥å¿—
./scripts.sh production logs [service-name]

# æŸ¥çœ‹èµ„æºä½¿ç”¨æƒ…å†µ
./scripts.sh production monitor
```

### æ•°æ®å¤‡ä»½
```bash
# åˆ›å»ºå®Œæ•´å¤‡ä»½
./scripts.sh production backup

# ä»…å¤‡ä»½æ•°æ®åº“
./scripts.sh database backup-only

# æ¢å¤å¤‡ä»½
./scripts.sh production restore [backup-file]
```

### æœåŠ¡ç®¡ç†
```bash
# é‡å¯ç‰¹å®šæœåŠ¡
docker-compose restart [service-name]

# æŸ¥çœ‹å®¹å™¨çŠ¶æ€
docker ps

# è¿›å…¥å®¹å™¨è°ƒè¯•
docker exec -it [container-name] /bin/sh
```

## ğŸš¨ å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ

### æ„å»ºé˜¶æ®µé”™è¯¯

**é—®é¢˜**: `Invalid URL` é”™è¯¯
```
Error occurred prerendering page "/weekly". TypeError: Invalid URL
```

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ£€æŸ¥ç¯å¢ƒå˜é‡é…ç½®
cat frontend/.env.local | grep SITE_URL

# é‡æ–°ç”Ÿæˆé…ç½®
./deployment/configure-unified-env.sh integrated yourdomain.com

# æ¸…ç†ç¼“å­˜é‡æ–°æ„å»º
docker-compose build --no-cache frontend
```

**é—®é¢˜**: Dockeræ„å»ºè¶…æ—¶
```
failed to solve: process did not complete successfully: exit code: 1
```

**è§£å†³æ–¹æ¡ˆ**:
```bash
# å¢åŠ Dockerèµ„æºé™åˆ¶
echo '{"max-concurrent-downloads": 3}' > /etc/docker/daemon.json
systemctl restart docker

# ä½¿ç”¨å›½å†…é•œåƒæº
npm config set registry https://registry.npmmirror.com
```

### è¿è¡Œæ—¶é”™è¯¯

**é—®é¢˜**: æ•°æ®åº“è¿æ¥å¤±è´¥
```
Error: connect ECONNREFUSED 127.0.0.1:5432
```

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ£€æŸ¥æ•°æ®åº“å®¹å™¨çŠ¶æ€
docker logs aibianx-postgres

# é‡å¯æ•°æ®åº“æœåŠ¡
docker-compose restart postgres

# æ£€æŸ¥ç½‘ç»œè¿æ¥
docker network ls
docker network inspect aibianx-integrated_integrated-network
```

**é—®é¢˜**: å‰ç«¯é¡µé¢ç™½å±
```
Application error: a client-side exception has occurred
```

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ£€æŸ¥å‰ç«¯æ—¥å¿—
docker logs aibianx-frontend

# éªŒè¯åç«¯APIè¿æ¥
curl http://localhost:1337/api/articles

# é‡æ–°æ„å»ºå‰ç«¯
docker-compose build --no-cache frontend
docker-compose up -d frontend
```

## ğŸ” å®‰å…¨é…ç½®

### SSLè¯ä¹¦é…ç½®
```bash
# å®‰è£…Certbot
apt install certbot python3-certbot-nginx

# ç”³è¯·SSLè¯ä¹¦
certbot --nginx -d yourdomain.com -d mail.yourdomain.com

# è‡ªåŠ¨ç»­æœŸ
echo "0 12 * * * /usr/bin/certbot renew --quiet" | crontab -
```

### é˜²ç«å¢™é…ç½®
```bash
# å¼€æ”¾å¿…è¦ç«¯å£
ufw allow 22        # SSH
ufw allow 80        # HTTP
ufw allow 443       # HTTPS
ufw allow 8080      # BillionMail
ufw allow 25        # SMTP
ufw allow 587       # SMTP Submission
ufw allow 465       # SMTPS
ufw allow 993       # IMAPS
ufw allow 995       # POP3S
ufw enable
```

### æ•°æ®å®‰å…¨
```bash
# å®šæœŸæ•°æ®å¤‡ä»½ (æ¯æ—¥å‡Œæ™¨2ç‚¹)
echo "0 2 * * * cd /opt/aibianx && ./scripts.sh production backup" | crontab -

# æ—¥å¿—è½®è½¬
echo "/opt/aibianx/logs/*.log {
    daily
    missingok
    rotate 30
    compress
    delaycompress
    notifempty
    copytruncate
}" > /etc/logrotate.d/aibianx
```

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### æ•°æ®åº“ä¼˜åŒ–
```bash
# PostgreSQLé…ç½®ä¼˜åŒ–
echo "
shared_buffers = 256MB
effective_cache_size = 1GB
maintenance_work_mem = 64MB
checkpoint_completion_target = 0.9
wal_buffers = 16MB
default_statistics_target = 100
random_page_cost = 1.1
effective_io_concurrency = 200
" >> /var/lib/postgresql/data/postgresql.conf
```

### ç¼“å­˜é…ç½®
```bash
# Redisé…ç½®ä¼˜åŒ–
echo "
maxmemory 512mb
maxmemory-policy allkeys-lru
save 900 1
save 300 10
save 60 10000
" >> /etc/redis/redis.conf
```

## ğŸ‰ éƒ¨ç½²æˆåŠŸéªŒè¯

éƒ¨ç½²å®Œæˆåï¼Œé€šè¿‡ä»¥ä¸‹æ£€æŸ¥ç¡®è®¤ç³»ç»Ÿæ­£å¸¸è¿è¡Œï¼š

### âœ… åŸºç¡€åŠŸèƒ½æ£€æŸ¥
- [ ] ç½‘ç«™é¦–é¡µæ­£å¸¸è®¿é—®: `https://yourdomain.com`
- [ ] åå°ç®¡ç†æ­£å¸¸ç™»å½•: `https://yourdomain.com/admin`
- [ ] APIæ¥å£æ­£å¸¸å“åº”: `https://yourdomain.com/api/articles`
- [ ] é‚®ä»¶ç³»ç»Ÿç®¡ç†ç•Œé¢: `https://yourdomain.com:8080/billion`

### âœ… æœåŠ¡çŠ¶æ€æ£€æŸ¥
```bash
# æ‰€æœ‰å®¹å™¨è¿è¡Œæ­£å¸¸
docker ps | grep aibianx

# æ•°æ®åº“è¿æ¥æ­£å¸¸
docker exec aibianx-postgres psql -U postgres -d aibianx -c "SELECT version();"

# æœç´¢å¼•æ“æ­£å¸¸
curl http://localhost:7700/health

# ç¼“å­˜æœåŠ¡æ­£å¸¸
docker exec aibianx-redis redis-cli ping
```

### âœ… åŠŸèƒ½å®Œæ•´æ€§æ£€æŸ¥
- [ ] æ–‡ç« åˆ—è¡¨åŠ è½½æ­£å¸¸
- [ ] æœç´¢åŠŸèƒ½å·¥ä½œæ­£å¸¸
- [ ] ç”¨æˆ·æ³¨å†Œç™»å½•åŠŸèƒ½
- [ ] é‚®ä»¶å‘é€åŠŸèƒ½æ­£å¸¸
- [ ] ç®¡ç†åå°CRUDæ“ä½œ

## ğŸ”„ æ›´æ–°å’Œç»´æŠ¤

### ä»£ç æ›´æ–°
```bash
# æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬
cd /opt/aibianx
git pull origin master
docker-compose build --no-cache
docker-compose up -d
```

### æ•°æ®åº“è¿ç§»
```bash
# æ‰§è¡Œæ•°æ®åº“è¿ç§»
docker exec aibianx-backend npm run strapi migration:run
```

### ç›‘æ§å’ŒæŠ¥è­¦
```bash
# è®¾ç½®ç³»ç»Ÿç›‘æ§
./scripts.sh production monitor

# é…ç½®æŠ¥è­¦é€šçŸ¥ (å¯é€‰)
./scripts.sh production alert-config
```

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœåœ¨éƒ¨ç½²è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼š

1. **æŸ¥çœ‹è¯¦ç»†æ—¥å¿—**: `./scripts.sh production logs`
2. **è¿è¡Œè¯Šæ–­å·¥å…·**: `./scripts.sh tools diagnose`
3. **æŸ¥çœ‹æ•…éšœæ’æŸ¥æ–‡æ¡£**: `docs/é—®é¢˜è§£å†³/`
4. **æäº¤Issue**: [GitHub Issues](https://github.com/lyfe2025/aibianx/issues)

---

**ğŸ¯ éƒ¨ç½²æˆåŠŸæ ‡å¿—**: å½“ä½ èƒ½å¤Ÿæ­£å¸¸è®¿é—®æ‰€æœ‰æœåŠ¡ï¼Œå¹¶ä¸”åŠŸèƒ½æ£€æŸ¥å…¨éƒ¨é€šè¿‡æ—¶ï¼Œè¯´æ˜éƒ¨ç½²æˆåŠŸï¼

è®°å¾—å®šæœŸå¤‡ä»½æ•°æ®å¹¶ä¿æŒç³»ç»Ÿæ›´æ–°ã€‚ç¥ä½ ä½¿ç”¨æ„‰å¿«ï¼ ğŸš€