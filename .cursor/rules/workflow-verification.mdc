# å·¥ä½œæµå’ŒéªŒè¯è§„èŒƒ (Workflow & Verification Rules)

## ğŸ“‹ **ä»£ç æäº¤å‰å¼ºåˆ¶è‡ªæ£€æ¸…å•ï¼ˆé˜²æ­¢99%çš„é”™è¯¯ï¼‰**
```bash
# ğŸ”¥ æ¯æ¬¡ä»£ç æäº¤å‰å¿…é¡»100%å®Œæˆä»¥ä¸‹æ£€æŸ¥æ¸…å•

echo "ğŸš€ å¼€å§‹ä»£ç æäº¤å‰æ£€æŸ¥..."

# âœ… ç¬¬1æ­¥ï¼šåŸºç¡€ä»£ç è´¨é‡æ£€æŸ¥
echo "1ï¸âƒ£ åŸºç¡€ä»£ç è´¨é‡æ£€æŸ¥"
echo "   æ£€æŸ¥TypeScriptç±»å‹é”™è¯¯..."
npx tsc --noEmit && echo "   âœ… ç±»å‹æ£€æŸ¥é€šè¿‡" || { echo "   âŒ ç±»å‹æ£€æŸ¥å¤±è´¥"; exit 1; }

echo "   æ£€æŸ¥ESLintè§„åˆ™..."
npm run lint && echo "   âœ… ESLintæ£€æŸ¥é€šè¿‡" || { echo "   âŒ ESLintæ£€æŸ¥å¤±è´¥"; exit 1; }

echo "   æ£€æŸ¥Prettieræ ¼å¼..."
npx prettier --check . && echo "   âœ… ä»£ç æ ¼å¼æ­£ç¡®" || { echo "   âŒ ä»£ç æ ¼å¼éœ€è¦ä¿®å¤"; exit 1; }

# âœ… ç¬¬2æ­¥ï¼šæ–‡ä»¶å‘½åå’Œè·¯å¾„æ£€æŸ¥
echo "2ï¸âƒ£ æ–‡ä»¶å‘½åè§„èŒƒæ£€æŸ¥"
echo "   æ£€æŸ¥ç»„ä»¶æ–‡ä»¶å‘½å..."
find frontend/src/components -name "*.tsx" | grep -v "^[A-Z]" && echo "   âŒ ç»„ä»¶æ–‡ä»¶å‘½åé”™è¯¯" || echo "   âœ… ç»„ä»¶å‘½åæ­£ç¡®"

echo "   æ£€æŸ¥APIè·¯ç”±å‘½å..."
find frontend/src/app/api -name "route.ts" | grep -E "[A-Z]" && echo "   âŒ APIè·¯ç”±åº”ä½¿ç”¨kebab-case" || echo "   âœ… APIè·¯ç”±å‘½åæ­£ç¡®"

# âœ… ç¬¬3æ­¥ï¼šå¯¼å…¥å¯¼å‡ºæ£€æŸ¥
echo "3ï¸âƒ£ å¯¼å…¥å¯¼å‡ºè§„èŒƒæ£€æŸ¥"
echo "   æ£€æŸ¥ç›¸å¯¹è·¯å¾„æ·±åº¦..."
grep -r "\.\./\.\./\.\." frontend/src/ && echo "   âŒ å‘ç°è¶…è¿‡3å±‚çš„ç›¸å¯¹è·¯å¾„" || echo "   âœ… ç›¸å¯¹è·¯å¾„ä½¿ç”¨æ­£ç¡®"

echo "   æ£€æŸ¥å¾ªç¯ä¾èµ–..."
npx madge --circular frontend/src/ && echo "   âŒ å‘ç°å¾ªç¯ä¾èµ–" || echo "   âœ… æ— å¾ªç¯ä¾èµ–"

# âœ… ç¬¬4æ­¥ï¼šAPIå’Œæ•°æ®åº“æ£€æŸ¥
echo "4ï¸âƒ£ APIå’Œæ•°æ®åº“æ£€æŸ¥"
echo "   æ£€æŸ¥APIç«¯ç‚¹å¯è®¿é—®æ€§..."
curl -s "http://localhost:1337/api/articles" > /dev/null && echo "   âœ… æ ¸å¿ƒAPIæ­£å¸¸" || echo "   âŒ APIè®¿é—®å¤±è´¥"

echo "   æ£€æŸ¥æ•°æ®åº“è¿æ¥..."
psql -U aibianx_dev -d aibianx_dev -c "SELECT 1;" > /dev/null 2>&1 && echo "   âœ… æ•°æ®åº“è¿æ¥æ­£å¸¸" || echo "   âŒ æ•°æ®åº“è¿æ¥å¤±è´¥"

# âœ… ç¬¬5æ­¥ï¼šç¯å¢ƒå˜é‡å’Œé…ç½®æ£€æŸ¥
echo "5ï¸âƒ£ ç¯å¢ƒå˜é‡æ£€æŸ¥"
echo "   æ£€æŸ¥å¿…éœ€çš„ç¯å¢ƒå˜é‡..."
test -f backend/.env && test -f frontend/.env.local && echo "   âœ… ç¯å¢ƒå˜é‡æ–‡ä»¶å­˜åœ¨" || echo "   âŒ ç¯å¢ƒå˜é‡æ–‡ä»¶ç¼ºå¤±"

echo "   æ£€æŸ¥ç¡¬ç¼–ç URL..."
grep -r "localhost:1337\|localhost:3000" frontend/src/ backend/src/ && echo "   âŒ å‘ç°ç¡¬ç¼–ç URL" || echo "   âœ… æ— ç¡¬ç¼–ç URL"

# âœ… ç¬¬6æ­¥ï¼šæ ·å¼å’ŒUIæ£€æŸ¥
echo "6ï¸âƒ£ æ ·å¼å’ŒUIæ£€æŸ¥"
echo "   æ£€æŸ¥CSSå˜é‡ä½¿ç”¨..."
grep -r "color: #[0-9a-fA-F]" frontend/src/styles/ && echo "   âŒ å‘ç°ç¡¬ç¼–ç é¢œè‰²" || echo "   âœ… CSSå˜é‡ä½¿ç”¨æ­£ç¡®"

echo "   æ£€æŸ¥å“åº”å¼è®¾è®¡..."
grep -r "@media" frontend/src/styles/ | wc -l | xargs echo "   åª’ä½“æŸ¥è¯¢æ•°é‡:"

# âœ… ç¬¬7æ­¥ï¼šå®‰å…¨æ£€æŸ¥
echo "7ï¸âƒ£ å®‰å…¨æ£€æŸ¥"
echo "   æ£€æŸ¥æ•æ„Ÿä¿¡æ¯æ³„éœ²..."
grep -r "password\|secret\|key" --include="*.ts" --include="*.tsx" frontend/src/ | grep -v "\.env" && echo "   âŒ å¯èƒ½å­˜åœ¨æ•æ„Ÿä¿¡æ¯" || echo "   âœ… æ— æ•æ„Ÿä¿¡æ¯æ³„éœ²"

echo "   æ£€æŸ¥console.logæ¸…ç†..."
grep -r "console\.log\|console\.error" frontend/src/ | grep -v "debugLog" && echo "   âš ï¸  å­˜åœ¨consoleè¾“å‡ºï¼Œå»ºè®®æ¸…ç†" || echo "   âœ… consoleè¾“å‡ºå·²æ¸…ç†"

# âœ… ç¬¬8æ­¥ï¼šæ€§èƒ½æ£€æŸ¥
echo "8ï¸âƒ£ æ€§èƒ½æ£€æŸ¥"
echo "   æ£€æŸ¥Bundleå¤§å°..."
cd frontend && npm run build > /tmp/build.log 2>&1
grep "First Load JS" /tmp/build.log | awk '{print $4}' | sed 's/kB//' | awk '$1 > 500 {print "   âŒ Bundleè¿‡å¤§: " $1 "kB"; exit 1}' || echo "   âœ… Bundleå¤§å°åˆç†"

echo "   æ£€æŸ¥å›¾ç‰‡ä¼˜åŒ–..."
find frontend/public/images -type f \( -name "*.jpg" -o -name "*.png" \) -size +500k | head -3 | while read file; do echo "   âš ï¸  å›¾ç‰‡è¾ƒå¤§: $file"; done

# âœ… ç¬¬9æ­¥ï¼šæµ‹è¯•è¦†ç›–æ£€æŸ¥
echo "9ï¸âƒ£ æµ‹è¯•æ£€æŸ¥"
echo "   è¿è¡Œå‰ç«¯æµ‹è¯•..."
cd frontend && npm run test 2>/dev/null && echo "   âœ… å‰ç«¯æµ‹è¯•é€šè¿‡" || echo "   âš ï¸  å‰ç«¯æµ‹è¯•éœ€è¦å®Œå–„"

echo "   æ£€æŸ¥å…³é”®åŠŸèƒ½..."
curl -s "http://localhost:1337/api/articles?pagination[pageSize]=1" | jq '.data | length' > /dev/null && echo "   âœ… å…³é”®åŠŸèƒ½æ­£å¸¸" || echo "   âŒ å…³é”®åŠŸèƒ½å¼‚å¸¸"

# âœ… ç¬¬10æ­¥ï¼šæ–‡æ¡£å’Œæ³¨é‡Šæ£€æŸ¥
echo "ğŸ”Ÿ æ–‡æ¡£æ£€æŸ¥"
echo "   æ£€æŸ¥APIæ–‡æ¡£æ›´æ–°..."
git diff --name-only | grep -q "API-ENDPOINTS.md" && echo "   âœ… APIæ–‡æ¡£å·²æ›´æ–°" || echo "   âš ï¸  æ£€æŸ¥æ˜¯å¦éœ€è¦æ›´æ–°APIæ–‡æ¡£"

echo "   æ£€æŸ¥ä»£ç æ³¨é‡Š..."
find frontend/src/components -name "*.tsx" -exec grep -L "\/\*\*\|\/\/" {} \; | head -3 | while read file; do echo "   âš ï¸  ç¼ºå°‘æ³¨é‡Š: $file"; done

echo ""
echo "ğŸ‰ æ‰€æœ‰æ£€æŸ¥å®Œæˆï¼"
echo ""
echo "ğŸ“‹ æœ€ç»ˆç¡®è®¤æ¸…å•ï¼ˆæ‰‹åŠ¨ç¡®è®¤ï¼‰ï¼š"
echo "   - [ ] åŠŸèƒ½ç¬¦åˆéœ€æ±‚"
echo "   - [ ] ä»£ç é€»è¾‘æ¸…æ™°"
echo "   - [ ] é”™è¯¯å¤„ç†å®Œæ•´"
echo "   - [ ] ç”¨æˆ·ä½“éªŒè‰¯å¥½"
echo "   - [ ] æ€§èƒ½æ»¡è¶³è¦æ±‚"
echo "   - [ ] å®‰å…¨æªæ–½åˆ°ä½"
echo "   - [ ] æµ‹è¯•è¦†ç›–å……åˆ†"
echo "   - [ ] æ–‡æ¡£æ›´æ–°åŠæ—¶"
echo ""
echo "âœ… ç¡®è®¤æ— è¯¯åæ–¹å¯æäº¤ä»£ç ï¼"
```

## ğŸ¯ **å¼ºåˆ¶æ€§å¼€å‘å·¥ä½œæµæ£€æŸ¥æ¸…å•ï¼ˆé˜²æ­¢é—æ¼ï¼‰**

### **ğŸ”¥ æ–°å»ºå†…å®¹ç±»å‹å·¥ä½œæµï¼ˆ7æ­¥éªŒè¯æ³•ï¼‰**

æ¯åˆ›å»ºä¸€ä¸ªæ–°çš„å†…å®¹ç±»å‹ï¼Œå¿…é¡»æŒ‰ä»¥ä¸‹é¡ºåºæ‰§è¡Œå¹¶éªŒè¯ï¼ˆä¸ä¸Šé¢çš„é“å¾‹ä¿æŒä¸€è‡´ï¼‰ï¼š

```bash
# ğŸ“‹ ç¬¬1æ­¥ï¼šåˆ›å»ºå†…å®¹ç±»å‹
echo "âœ… æ­¥éª¤1: Adminç•Œé¢åˆ›å»ºå†…å®¹ç±»å‹"
echo "ğŸ” éªŒè¯å‘½ä»¤:"
curl -s "http://localhost:1337/api/[content-types]" | jq '.error.status'
echo "æœŸæœ›ç»“æœ: 403 (éœ€è¦æƒé™) æˆ– 200 (æˆåŠŸ)"
echo ""

# ğŸ“‹ ç¬¬2æ­¥ï¼šè‡ªåŠ¨æ·»åŠ å­—æ®µæè¿°
echo "âœ… æ­¥éª¤2: è‡ªåŠ¨æ·»åŠ å­—æ®µæè¿°"
echo "ğŸ” æ‰§è¡Œå‘½ä»¤:"
./scripts.sh tools fix-fields-any [content-type]
echo "ğŸ” éªŒè¯: è„šæœ¬è‡ªåŠ¨æ·»åŠ ï¼ŒAdminç•Œé¢æ£€æŸ¥ä¸­æ–‡æè¿°å·²ç”Ÿæ•ˆ"
echo ""

# ğŸ“‹ ç¬¬3æ­¥ï¼šæ·»åŠ æ•°æ®åº“æ³¨é‡Š  
echo "âœ… æ­¥éª¤3: æ·»åŠ æ•°æ®åº“æ³¨é‡Š"
echo "ğŸ” éªŒè¯å‘½ä»¤:"
psql -U aibianx_dev -d aibianx_dev -c "
SELECT column_name, col_description(pgc.oid, cols.ordinal_position) as comment
FROM information_schema.columns cols
INNER JOIN pg_class pgc ON pgc.relname = cols.table_name
WHERE table_name = '[table_name]' AND table_schema = 'public';"
echo "æœŸæœ›ç»“æœ: æ¯ä¸ªå­—æ®µéƒ½æœ‰ä¸­æ–‡æ³¨é‡Š"
echo ""

# ğŸ“‹ ç¬¬4æ­¥ï¼šé…ç½®APIæƒé™
echo "âœ… æ­¥éª¤4: é…ç½®APIæƒé™"
echo "ğŸ” éªŒè¯å‘½ä»¤:"
curl -s "http://localhost:1337/api/[content-types]?pagination[pageSize]=1" | jq '.data | length'
echo "æœŸæœ›ç»“æœ: è¿”å›æ•°å­—ï¼ˆæˆåŠŸï¼‰"
echo ""

# ğŸ“‹ ç¬¬5æ­¥ï¼šæµ‹è¯•APIç«¯ç‚¹
echo "âœ… æ­¥éª¤5: æµ‹è¯•APIç«¯ç‚¹"
echo "ğŸ” æµ‹è¯•å‘½ä»¤:"
curl -s "http://localhost:1337/api/[content-types]" | jq '.data'
curl -s "http://localhost:1337/api/[content-types]?populate=*" | jq '.data[0].attributes'
echo "æœŸæœ›ç»“æœ: è¿”å›æ•°æ®ç»“æ„æ­£ç¡®"
echo ""

# ğŸ“‹ ç¬¬6æ­¥ï¼šå‰ç«¯é›†æˆæµ‹è¯•
echo "âœ… æ­¥éª¤6: å‰ç«¯é›†æˆæµ‹è¯•"
echo "ğŸ” æµ‹è¯•å‘½ä»¤:"
curl -s "http://localhost/api/test-[content-type]" | jq '.status'
echo "æœŸæœ›ç»“æœ: success"
echo ""

# ğŸ“‹ ç¬¬7æ­¥ï¼šæœ€ç»ˆéªŒè¯
echo "âœ… æ­¥éª¤7: æœ€ç»ˆéªŒè¯æ¸…å•"
echo "ğŸ” æ£€æŸ¥æ¸…å•:"
echo "  - [ ] æ•°æ®åº“æ³¨é‡Šå®Œæ•´"
echo "  - [ ] å­—æ®µæè¿°æ˜¾ç¤ºä¸­æ–‡"
echo "  - [ ] APIæƒé™é…ç½®æ­£ç¡®"
echo "  - [ ] APIç«¯ç‚¹æ­£å¸¸è®¿é—®"
echo "  - [ ] å‰ç«¯é›†æˆæˆåŠŸ"
echo "  - [ ] æµ‹è¯•æ•°æ®åˆ›å»ºæˆåŠŸ"
```

### **ğŸ”¥ APIå¼€å‘å·¥ä½œæµï¼ˆ5æ­¥éªŒè¯æ³•ï¼‰**

æ¯å¼€å‘ä¸€ä¸ªæ–°çš„APIç«¯ç‚¹ï¼Œå¿…é¡»æ‰§è¡Œä»¥ä¸‹éªŒè¯ï¼š

```bash
# ğŸ“‹ APIå¼€å‘éªŒè¯è„šæœ¬
echo "ğŸ”¥ APIå¼€å‘éªŒè¯æ¸…å•"
echo ""

# ç¬¬1æ­¥ï¼šä»£ç è´¨é‡æ£€æŸ¥
echo "âœ… æ­¥éª¤1: ä»£ç è´¨é‡æ£€æŸ¥"
echo "ğŸ” æ£€æŸ¥é¡¹ç›®:"
echo "  - [ ] ä½¿ç”¨ES6è¯­æ³• (import/export)"
echo "  - [ ] åŒ…å«é”™è¯¯å¤„ç† (try/catch)"
echo "  - [ ] å‚æ•°éªŒè¯å®Œæ•´"
echo "  - [ ] è¿”å›æ ¼å¼æ ‡å‡†"
echo ""

# ç¬¬2æ­¥ï¼šAPIç«¯ç‚¹æµ‹è¯•
echo "âœ… æ­¥éª¤2: APIç«¯ç‚¹æµ‹è¯•"
echo "ğŸ” æµ‹è¯•å‘½ä»¤:"
echo "# åŸºç¡€åŠŸèƒ½æµ‹è¯•"
curl -s "http://localhost:1337/api/[endpoint]" | jq '.'
echo "# åˆ†é¡µæµ‹è¯•"
curl -s "http://localhost:1337/api/[endpoint]?pagination[pageSize]=5" | jq '.meta.pagination'
echo "# é”™è¯¯æƒ…å†µæµ‹è¯•"
curl -s "http://localhost:1337/api/[endpoint]/invalid-id" | jq '.error'
echo ""

# ç¬¬3æ­¥ï¼šæƒé™éªŒè¯
echo "âœ… æ­¥éª¤3: æƒé™éªŒè¯"
echo "ğŸ” éªŒè¯å‘½ä»¤:"
curl -s "http://localhost:1337/api/[endpoint]" | jq '.error.status'
echo "æœŸæœ›ç»“æœ: 200 (æˆåŠŸ) æˆ– æ­£ç¡®çš„é”™è¯¯çŠ¶æ€ç "
echo ""

# ç¬¬4æ­¥ï¼šå‰ç«¯é›†æˆ
echo "âœ… æ­¥éª¤4: å‰ç«¯é›†æˆ"
echo "ğŸ” æ£€æŸ¥é¡¹ç›®:"
echo "  - [ ] APIå®¢æˆ·ç«¯å‡½æ•°å·²åˆ›å»º"
echo "  - [ ] TypeScriptç±»å‹å·²å®šä¹‰"
echo "  - [ ] é”™è¯¯å¤„ç†å·²å®ç°"
echo "  - [ ] åŠ è½½çŠ¶æ€å·²å¤„ç†"
echo ""

# ç¬¬5æ­¥ï¼šæ–‡æ¡£æ›´æ–°
echo "âœ… æ­¥éª¤5: æ–‡æ¡£æ›´æ–°"
echo "ğŸ” æ£€æŸ¥é¡¹ç›®:"
echo "  - [ ] API-ENDPOINTS.md å·²æ›´æ–°"
echo "  - [ ] ä»£ç æ³¨é‡Šå®Œæ•´"
echo "  - [ ] ç¤ºä¾‹ä»£ç å·²æ·»åŠ "
```

### **ğŸ”¥ å‰ç«¯ç»„ä»¶å¼€å‘å·¥ä½œæµï¼ˆ6æ­¥éªŒè¯æ³•ï¼‰**

æ¯å¼€å‘ä¸€ä¸ªæ–°ç»„ä»¶ï¼Œå¿…é¡»æ‰§è¡Œä»¥ä¸‹éªŒè¯ï¼š

```bash
# ğŸ“‹ å‰ç«¯ç»„ä»¶å¼€å‘éªŒè¯è„šæœ¬
echo "ğŸ”¥ å‰ç«¯ç»„ä»¶å¼€å‘éªŒè¯æ¸…å•"
echo ""

# ç¬¬1æ­¥ï¼šç»„ä»¶æ¶æ„æ£€æŸ¥
echo "âœ… æ­¥éª¤1: ç»„ä»¶æ¶æ„æ£€æŸ¥"
echo "ğŸ” æ£€æŸ¥é¡¹ç›®:"
echo "  - [ ] æ–‡ä»¶ç»“æ„ç¬¦åˆåŸå­è®¾è®¡"
echo "  - [ ] Propsæ¥å£å®šä¹‰å®Œæ•´"
echo "  - [ ] TypeScriptç±»å‹å®‰å…¨"
echo "  - [ ] ç»„ä»¶èŒè´£å•ä¸€"
echo ""

# ç¬¬2æ­¥ï¼šæ ·å¼å®ç°æ£€æŸ¥
echo "âœ… æ­¥éª¤2: æ ·å¼å®ç°æ£€æŸ¥"
echo "ğŸ” æ£€æŸ¥é¡¹ç›®:"
echo "  - [ ] ä½¿ç”¨CSSå˜é‡ (éç¡¬ç¼–ç )"
echo "  - [ ] å“åº”å¼è®¾è®¡å®Œæ•´"
echo "  - [ ] ä¸»é¢˜å…¼å®¹æ€§æµ‹è¯•"
echo "  - [ ] æµè§ˆå™¨å…¼å®¹æ€§éªŒè¯"
echo ""

# ç¬¬3æ­¥ï¼šäº¤äº’çŠ¶æ€æ£€æŸ¥
echo "âœ… æ­¥éª¤3: äº¤äº’çŠ¶æ€æ£€æŸ¥"
echo "ğŸ” æ£€æŸ¥é¡¹ç›®:"
echo "  - [ ] LoadingçŠ¶æ€å¤„ç†"
echo "  - [ ] ErrorçŠ¶æ€å¤„ç†"
echo "  - [ ] ç©ºæ•°æ®çŠ¶æ€å¤„ç†"
echo "  - [ ] äº¤äº’åé¦ˆå®Œæ•´"
echo ""

# ç¬¬4æ­¥ï¼šæ•°æ®é›†æˆæ£€æŸ¥
echo "âœ… æ­¥éª¤4: æ•°æ®é›†æˆæ£€æŸ¥"
echo "ğŸ” æ£€æŸ¥é¡¹ç›®:"
echo "  - [ ] APIè°ƒç”¨é”™è¯¯å¤„ç†"
echo "  - [ ] æ•°æ®æ ¼å¼éªŒè¯"
echo "  - [ ] ç¼“å­˜ç­–ç•¥å®ç°"
echo "  - [ ] æ€§èƒ½ä¼˜åŒ–è€ƒè™‘"
echo ""

# ç¬¬5æ­¥ï¼šå¯è®¿é—®æ€§æ£€æŸ¥
echo "âœ… æ­¥éª¤5: å¯è®¿é—®æ€§æ£€æŸ¥"
echo "ğŸ” æ£€æŸ¥é¡¹ç›®:"
echo "  - [ ] aria-label å±æ€§"
echo "  - [ ] é”®ç›˜å¯¼èˆªæ”¯æŒ"
echo "  - [ ] å±å¹•é˜…è¯»å™¨å‹å¥½"
echo "  - [ ] é¢œè‰²å¯¹æ¯”åº¦ç¬¦åˆæ ‡å‡†"
echo ""

# ç¬¬6æ­¥ï¼šæµ‹è¯•éªŒè¯
echo "âœ… æ­¥éª¤6: æµ‹è¯•éªŒè¯"
echo "ğŸ” æ£€æŸ¥é¡¹ç›®:"
echo "  - [ ] å•å…ƒæµ‹è¯•è¦†ç›–"
echo "  - [ ] é›†æˆæµ‹è¯•é€šè¿‡"
echo "  - [ ] è§†è§‰å›å½’æµ‹è¯•"
echo "  - [ ] æ€§èƒ½æµ‹è¯•è¾¾æ ‡"
```

### **ğŸ”¥ éƒ¨ç½²å‰æœ€ç»ˆæ£€æŸ¥æ¸…å•ï¼ˆä¸€é”®éªŒè¯ï¼‰**

```bash
#!/bin/bash
# ğŸ“‹ éƒ¨ç½²å‰æœ€ç»ˆæ£€æŸ¥è„šæœ¬

echo "ğŸš€ éƒ¨ç½²å‰æœ€ç»ˆæ£€æŸ¥æ¸…å•"
echo "========================"

# ç¯å¢ƒé…ç½®æ£€æŸ¥
echo "ğŸ” 1. ç¯å¢ƒé…ç½®æ£€æŸ¥"
if [ -f "backend/.env" ] && [ -f "frontend/.env.local" ]; then
    echo "âœ… ç¯å¢ƒå˜é‡æ–‡ä»¶å­˜åœ¨"
else
    echo "âŒ ç¯å¢ƒå˜é‡æ–‡ä»¶ç¼ºå¤±"
    exit 1
fi

# æ•°æ®åº“è¿æ¥æ£€æŸ¥
echo "ğŸ” 2. æ•°æ®åº“è¿æ¥æ£€æŸ¥"
psql -U aibianx_dev -d aibianx_dev -c "SELECT 1;" > /dev/null 2>&1
if [ $? -eq 0 ]; then
    echo "âœ… æ•°æ®åº“è¿æ¥æ­£å¸¸"
else
    echo "âŒ æ•°æ®åº“è¿æ¥å¤±è´¥"
    exit 1
fi

# APIç«¯ç‚¹æ£€æŸ¥
echo "ğŸ” 3. æ ¸å¿ƒAPIç«¯ç‚¹æ£€æŸ¥"
api_status=$(curl -s "http://localhost:1337/api/articles" | jq -r '.data | length // "error"')
if [ "$api_status" != "error" ]; then
    echo "âœ… APIç«¯ç‚¹æ­£å¸¸"
else
    echo "âŒ APIç«¯ç‚¹å¼‚å¸¸"
    exit 1
fi

# é‚®ä»¶æœåŠ¡æ£€æŸ¥
echo "ğŸ” 4. é‚®ä»¶æœåŠ¡æ£€æŸ¥"
email_status=$(curl -s "http://localhost:1337/api/email-service/health" | jq -r '.status // "error"')
if [ "$email_status" = "healthy" ]; then
    echo "âœ… é‚®ä»¶æœåŠ¡æ­£å¸¸"
else
    echo "âš ï¸  é‚®ä»¶æœåŠ¡éœ€è¦æ£€æŸ¥"
fi

# æœç´¢æœåŠ¡æ£€æŸ¥
echo "ğŸ” 5. æœç´¢æœåŠ¡æ£€æŸ¥"
search_status=$(curl -s "http://localhost:7700/health" | jq -r '.status // "error"')
if [ "$search_status" = "available" ]; then
    echo "âœ… æœç´¢æœåŠ¡æ­£å¸¸"
else
    echo "âš ï¸  æœç´¢æœåŠ¡éœ€è¦æ£€æŸ¥"
fi

# å‰ç«¯ç¼–è¯‘æ£€æŸ¥
echo "ğŸ” 6. å‰ç«¯ç¼–è¯‘æ£€æŸ¥"
cd frontend
npm run build > /dev/null 2>&1
if [ $? -eq 0 ]; then
    echo "âœ… å‰ç«¯ç¼–è¯‘æˆåŠŸ"
    cd ..
else
    echo "âŒ å‰ç«¯ç¼–è¯‘å¤±è´¥"
    cd ..
    exit 1
fi

# å®‰å…¨é…ç½®æ£€æŸ¥
echo "ğŸ” 7. å®‰å…¨é…ç½®æ£€æŸ¥"
echo "ğŸ” æ£€æŸ¥é¡¹ç›®:"
echo "  - [ ] HTTPSé…ç½® (ç”Ÿäº§ç¯å¢ƒ)"
echo "  - [ ] å®‰å…¨å¤´é…ç½®"
echo "  - [ ] APIé€Ÿç‡é™åˆ¶"
echo "  - [ ] è¾“å…¥éªŒè¯å®Œæ•´"
echo "  - [ ] æ—¥å¿—è®°å½•å®Œæ•´"

echo ""
echo "ğŸ‰ æ‰€æœ‰æ£€æŸ¥å®Œæˆï¼"
echo "ğŸ“‹ æ‰‹åŠ¨ç¡®è®¤æ¸…å•:"
echo "  - [ ] æ•°æ®åº“å¤‡ä»½å·²å®Œæˆ"
echo "  - [ ] ç‰ˆæœ¬å·å·²æ›´æ–°"
echo "  - [ ] æ›´æ–°æ—¥å¿—å·²è®°å½•"
echo "  - [ ] æµ‹è¯•ç¯å¢ƒéªŒè¯é€šè¿‡"
echo "  - [ ] å›æ»šæ–¹æ¡ˆå·²å‡†å¤‡"
```

## **âš¡ å¿«é€ŸéªŒè¯å‘½ä»¤é›†åˆï¼ˆé›†æˆä¸Šè¿°æ‰€æœ‰æ£€æŸ¥ï¼‰**

```bash
# ğŸ”¥ ä¸€é”®éªŒè¯æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½ï¼ˆå‡çº§ç‰ˆï¼‰
alias verify-all='
echo "ğŸš€ å¼€å§‹å…¨é¢éªŒè¯..." &&
echo "éªŒè¯åç«¯API..." && curl -s "http://localhost:1337/api/articles?pagination[pageSize]=1" | jq ".data | length" &&
echo "éªŒè¯å‰ç«¯é¡µé¢..." && curl -s "http://localhost" | grep -o "<title>" &&
echo "éªŒè¯æ•°æ®åº“..." && psql -U aibianx_dev -d aibianx_dev -c "SELECT COUNT(*) FROM articles;" &&
echo "éªŒè¯é‚®ä»¶æœåŠ¡..." && curl -s "http://localhost:1337/api/email-service/health" | jq ".status" &&
echo "éªŒè¯æœç´¢æœåŠ¡..." && curl -s "http://localhost:7700/health" | jq ".status" &&
echo "éªŒè¯ç¯å¢ƒå˜é‡..." && test -f backend/.env && test -f frontend/.env.local && echo "âœ… ç¯å¢ƒå˜é‡å­˜åœ¨" &&
echo "éªŒè¯ç¼“å­˜çŠ¶æ€..." && ! test -d frontend/.next && ! test -d backend/.tmp && echo "âœ… ç¼“å­˜å·²æ¸…ç†" &&
echo "âœ… æ‰€æœ‰éªŒè¯å®Œæˆ!"
'

# ğŸ”¥ å¿«é€Ÿå¼€å‘è´¨é‡æ£€æŸ¥ï¼ˆé›†æˆTypeScript + ESLintï¼‰
alias dev-check='
echo "ğŸ” å¼€å‘è´¨é‡æ£€æŸ¥..." &&
cd frontend && npx tsc --noEmit && echo "âœ… å‰ç«¯ç±»å‹æ£€æŸ¥é€šè¿‡" &&
cd ../backend && npx tsc --noEmit && echo "âœ… åç«¯ç±»å‹æ£€æŸ¥é€šè¿‡" &&
cd ../frontend && npm run lint && echo "âœ… å‰ç«¯ä»£ç è§„èŒƒé€šè¿‡" &&
echo "âœ… å¼€å‘è´¨é‡æ£€æŸ¥å®Œæˆ!"
'

# ğŸ”¥ å¿«é€Ÿé—®é¢˜è¯Šæ–­ï¼ˆå‡çº§ç‰ˆï¼‰
alias diagnose='
echo "ğŸ” å…¨é¢é—®é¢˜è¯Šæ–­å¼€å§‹..." &&
./scripts.sh tools status &&
echo "ğŸ” æ£€æŸ¥æœåŠ¡çŠ¶æ€..." &&
ps aux | grep -E "(node|postgres|meilisearch)" | grep -v grep &&
echo "ğŸ” æ£€æŸ¥ç«¯å£å ç”¨..." &&
lsof -i :80 -i :1337 -i :5432 -i :7700 2>/dev/null || echo "ç«¯å£æ£€æŸ¥éœ€è¦sudoæƒé™" &&
echo "ğŸ” æ£€æŸ¥æœ€æ–°é”™è¯¯æ—¥å¿—..." &&
test -f logs/backend.log && tail -n 10 logs/backend.log | grep -i error &&
test -f logs/frontend.log && tail -n 10 logs/frontend.log | grep -i error &&
echo "ğŸ” æ£€æŸ¥ç£ç›˜ç©ºé—´..." &&
df -h . | tail -1 | awk "{print \"ç£ç›˜ä½¿ç”¨ç‡: \" \$5}" &&
echo "ğŸ” è¯Šæ–­å®Œæˆ!"
'

# ğŸ”¥ å¿«é€Ÿç¼“å­˜å’Œé‡å¯ï¼ˆå‡çº§ç‰ˆï¼‰
alias fresh-start='
echo "ğŸ§¹ æ¸…ç†æ‰€æœ‰ç¼“å­˜..." &&
cd frontend && rm -rf .next node_modules/.cache &&
cd ../backend && rm -rf .tmp .cache build dist &&
echo "ğŸ”„ é‡å¯å¼€å‘ç¯å¢ƒ..." &&
./scripts.sh deploy stop &&
sleep 2 &&
./scripts.sh deploy start &&
echo "âœ… ç¯å¢ƒé‡å¯å®Œæˆ!"
'

# ğŸ”¥ ä»£ç æäº¤å‰å¿«é€Ÿæ£€æŸ¥ï¼ˆæ•´åˆç‰ˆï¼‰
alias pre-commit-quick='
echo "âš¡ å¿«é€Ÿæäº¤å‰æ£€æŸ¥..." &&
cd frontend && npx tsc --noEmit && npm run lint &&
cd ../backend && npx tsc --noEmit &&
curl -s "http://localhost:1337/api/articles" > /dev/null && echo "âœ… APIæ­£å¸¸" &&
git status --porcelain | grep -q "\.md$" && echo "âš ï¸  æ–‡æ¡£æ–‡ä»¶æœ‰å˜æ›´ï¼Œè¯·æ£€æŸ¥" || echo "âœ… æ–‡æ¡£çŠ¶æ€æ­£å¸¸" &&
echo "âœ… å¿«é€Ÿæ£€æŸ¥å®Œæˆï¼Œå¯ä»¥æäº¤ï¼"
'
```

### è„šæœ¬åˆ†ç±»ä½¿ç”¨ç¤ºä¾‹
```bash
# äº¤äº’å¼èœå•æ¨¡å¼
./scripts.sh

# å‘½ä»¤è¡Œæ¨¡å¼ - æœåŠ¡ç®¡ç†
./scripts.sh deploy start     # å¯åŠ¨å¼€å‘ç¯å¢ƒ
./scripts.sh deploy backend   # å¯åŠ¨åç«¯æœåŠ¡
./scripts.sh deploy frontend  # å¯åŠ¨å‰ç«¯æœåŠ¡
./scripts.sh deploy stop      # åœæ­¢æ‰€æœ‰æœåŠ¡

# å‘½ä»¤è¡Œæ¨¡å¼ - æœç´¢å¼•æ“
./scripts.sh search deploy    # éƒ¨ç½²MeiliSearch
./scripts.sh search manage    # æœç´¢ç®¡ç†å·¥å…·
./scripts.sh search restart   # é‡å¯æœç´¢æœåŠ¡
./scripts.sh search reindex   # é‡å»ºæœç´¢ç´¢å¼•
./scripts.sh search check     # æ£€æŸ¥æœç´¢çŠ¶æ€
./scripts.sh search logs      # æŸ¥çœ‹æœç´¢æ—¥å¿—

# å‘½ä»¤è¡Œæ¨¡å¼ - ç³»ç»Ÿç›‘æ§
./scripts.sh tools status     # æŸ¥çœ‹ç³»ç»ŸçŠ¶æ€
./scripts.sh db check         # æ£€æŸ¥æ•°æ®åº“
./scripts.sh backup full      # å®Œæ•´å¤‡ä»½

# å‘½ä»¤è¡Œæ¨¡å¼ - æ€§èƒ½ç›‘æ§
./scripts.sh tools monitor    # ç³»ç»Ÿæ€§èƒ½ç›‘æ§
./scripts.sh tools logs       # æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—
./scripts.sh tools health     # å¥åº·æ£€æŸ¥æŠ¥å‘Š

# å‘½ä»¤è¡Œæ¨¡å¼ - éªŒè¯æ£€æŸ¥ (æ–°å¢)
./scripts.sh tools verify-content-type [name]  # éªŒè¯å†…å®¹ç±»å‹é…ç½®
./scripts.sh tools verify-api [endpoint]       # éªŒè¯APIç«¯ç‚¹
./scripts.sh tools verify-deployment          # éªŒè¯éƒ¨ç½²å‡†å¤‡æƒ…å†µ

# å¿«é€Ÿæ£€æŸ¥åˆ«åï¼ˆé…åˆä½¿ç”¨ï¼‰
verify-all              # å…¨é¢ç³»ç»ŸéªŒè¯
dev-check               # å¼€å‘è´¨é‡æ£€æŸ¥
diagnose                # é—®é¢˜è¯Šæ–­
fresh-start             # æ¸…ç†ç¼“å­˜é‡å¯
pre-commit-quick        # å¿«é€Ÿæäº¤å‰æ£€æŸ¥
```