# Cursor å¼€å‘è§„èŒƒ (Development Rules)

## ğŸš¨ **Cursor å¼€å‘æ—¶å¿…é¡»éµå¾ªçš„é“å¾‹ï¼ˆé˜²æ­¢é‡å¤çŠ¯é”™ï¼‰**

### **ğŸ“ æ–‡ä»¶å’Œè·¯å¾„å‘½åé“å¾‹**
```typescript
// âœ… æ­£ç¡®çš„æ–‡ä»¶å‘½åè§„èŒƒï¼ˆä¸¥æ ¼éµå¾ªï¼‰
// ç»„ä»¶æ–‡ä»¶ï¼šPascalCase + .tsx
components/ui/GradientButton/GradientButton.tsx
components/molecules/ArticleCard/ArticleCard.tsx

// APIè·¯ç”±ï¼škebab-case + route.ts
app/api/test-articles/route.ts
app/api/email-service/route.ts

// æ ·å¼æ–‡ä»¶ï¼škebab-case + .css
styles/components.css
styles/theme-variables.css

// å·¥å…·å‡½æ•°ï¼šcamelCase + .ts
lib/strapiClient.ts
lib/emailService.ts

// âŒ ç»å¯¹ç¦æ­¢çš„å‘½åï¼ˆCursorå®¹æ˜“çŠ¯é”™ï¼‰
components/ui/gradient-button.tsx        // ç»„ä»¶åº”è¯¥ç”¨PascalCase
app/api/testArticles/route.ts           // APIè·¯ç”±åº”è¯¥ç”¨kebab-case
lib/strapi_client.ts                    // å·¥å…·å‡½æ•°åº”è¯¥ç”¨camelCase
styles/Components.css                   // æ ·å¼æ–‡ä»¶åº”è¯¥ç”¨kebab-case
```

### **ğŸ“¦ å¯¼å…¥å¯¼å‡ºè§„èŒƒï¼ˆé˜²æ­¢å¾ªç¯ä¾èµ–ï¼‰**
```typescript
// âœ… æ­£ç¡®çš„å¯¼å…¥é¡ºåºï¼ˆå¿…é¡»ä¸¥æ ¼éµå¾ªï¼‰
// 1. Reactç›¸å…³å¯¼å…¥
import React, { useState, useEffect } from 'react'
import type { FC } from 'react'

// 2. ç¬¬ä¸‰æ–¹åº“å¯¼å…¥
import { z } from 'zod'
import clsx from 'clsx'

// 3. å†…éƒ¨åº“å¯¼å…¥ï¼ˆæŒ‰è·¯å¾„æ·±åº¦æ’åºï¼‰
import { config } from '@/lib/config'
import { strapiClient } from '@/lib/strapi'

// 4. ç±»å‹å¯¼å…¥ï¼ˆæ”¾åœ¨æœ€åï¼Œä½¿ç”¨typeå…³é”®å­—ï¼‰
import type { Article, Author, Category } from '@/types/api'
import type { ComponentProps } from '@/types/components'

// âœ… æ­£ç¡®çš„å¯¼å‡ºæ ¼å¼
export { GradientButton } from './GradientButton'
export type { GradientButtonProps } from './GradientButton'
export default GradientButton

// âŒ ç»å¯¹ç¦æ­¢çš„å¯¼å…¥æ–¹å¼ï¼ˆå®¹æ˜“å¯¼è‡´å¾ªç¯ä¾èµ–ï¼‰
import '../../../lib/config'                    // ç›¸å¯¹è·¯å¾„è¶…è¿‡2å±‚
import { GradientButton, strapiClient } from '.'  // æ··åˆå¯¼å…¥ä¸åŒç±»å‹
export * from './components'                   // é¿å…ä½¿ç”¨export *
```

### **ğŸ”§ TypeScriptç±»å‹å®šä¹‰å¼ºåˆ¶æ›´æ–°è§„èŒƒ**
```typescript
// ğŸ”¥ æ¯æ¬¡æ–°å»ºå†…å®¹ç±»å‹åï¼Œå¿…é¡»ç«‹å³æ›´æ–°TypeScriptç±»å‹

// âœ… ç¬¬1æ­¥ï¼šæ›´æ–°APIç±»å‹å®šä¹‰ (types/api.ts)
export interface NewContentType {
  id: number
  name: string
  slug: string
  description?: string
  createdAt: string
  updatedAt: string
  publishedAt?: string
}

export interface NewContentTypeResponse {
  data: NewContentType[]
  meta: {
    pagination: Pagination
  }
}

// âœ… ç¬¬2æ­¥ï¼šæ›´æ–°Strapiå®¢æˆ·ç«¯ç±»å‹ (lib/strapi.ts)
export const strapiClient = {
  async getNewContentTypes(): Promise<NewContentType[]> {
    // å®ç°é€»è¾‘
  }
}

// âœ… ç¬¬3æ­¥ï¼šéªŒè¯ç±»å‹å®šä¹‰æ­£ç¡®æ€§
// è¿è¡ŒTypeScriptæ£€æŸ¥
npm run type-check

// âŒ ç»å¯¹ç¦æ­¢çš„ç±»å‹å®šä¹‰é”™è¯¯
interface BadType {
  data: any                    // ç¦æ­¢ä½¿ç”¨any
  items: object[]             // ç¦æ­¢ä½¿ç”¨object
  callback: Function          // ç¦æ­¢ä½¿ç”¨Function
}
```

### **ğŸŒ ç¯å¢ƒå˜é‡å¼ºåˆ¶éªŒè¯è§„èŒƒ**
```bash
# ğŸ”¥ æ¯æ¬¡ä¿®æ”¹ç¯å¢ƒå˜é‡åï¼Œå¿…é¡»ç«‹å³éªŒè¯

# âœ… ç¬¬1æ­¥ï¼šæ£€æŸ¥ç¯å¢ƒå˜é‡æ–‡ä»¶å­˜åœ¨
test -f backend/.env && echo "âœ… åç«¯ç¯å¢ƒå˜é‡å­˜åœ¨" || echo "âŒ åç«¯ç¯å¢ƒå˜é‡ç¼ºå¤±"
test -f frontend/.env.local && echo "âœ… å‰ç«¯ç¯å¢ƒå˜é‡å­˜åœ¨" || echo "âŒ å‰ç«¯ç¯å¢ƒå˜é‡ç¼ºå¤±"

# âœ… ç¬¬2æ­¥ï¼šéªŒè¯å…³é”®ç¯å¢ƒå˜é‡
echo "éªŒè¯åç«¯ç¯å¢ƒå˜é‡..."
cd backend && node -e "
const env = require('dotenv').config();
const required = ['DATABASE_HOST', 'DATABASE_NAME', 'DATABASE_USERNAME', 'JWT_SECRET'];
const missing = required.filter(key => !process.env[key]);
if (missing.length > 0) {
  console.log('âŒ ç¼ºå¤±ç¯å¢ƒå˜é‡:', missing.join(', '));
  process.exit(1);
} else {
  console.log('âœ… åç«¯ç¯å¢ƒå˜é‡å®Œæ•´');
}
"

echo "éªŒè¯å‰ç«¯ç¯å¢ƒå˜é‡..."
cd frontend && node -e "
const required = ['NEXT_PUBLIC_STRAPI_URL', 'NEXTAUTH_SECRET'];
const missing = required.filter(key => !process.env[key]);
if (missing.length > 0) {
  console.log('âŒ ç¼ºå¤±ç¯å¢ƒå˜é‡:', missing.join(', '));
  process.exit(1);
} else {
  console.log('âœ… å‰ç«¯ç¯å¢ƒå˜é‡å®Œæ•´');
}
"

# âœ… ç¬¬3æ­¥ï¼šéªŒè¯URLè¿é€šæ€§
curl -s "${NEXT_PUBLIC_STRAPI_URL}/api/articles" > /dev/null && echo "âœ… APIè¿æ¥æ­£å¸¸" || echo "âŒ APIè¿æ¥å¤±è´¥"
```

### **ğŸ§¹ ç¼“å­˜æ¸…ç†å¼ºåˆ¶æ—¶æœº**
```bash
# ğŸ”¥ ä»¥ä¸‹æƒ…å†µå¿…é¡»ç«‹å³æ¸…ç†ç¼“å­˜ï¼Œä¸å¯é—æ¼ï¼

# âœ… æƒ…å†µ1ï¼šä¿®æ”¹Strapi schemaå
echo "Schemaä¿®æ”¹åæ¸…ç†ç¼“å­˜..."
cd backend && rm -rf .tmp .cache build dist

# âœ… æƒ…å†µ2ï¼šä¿®æ”¹ç¯å¢ƒå˜é‡å  
echo "ç¯å¢ƒå˜é‡ä¿®æ”¹åæ¸…ç†ç¼“å­˜..."
cd frontend && rm -rf .next
cd backend && rm -rf .tmp

# âœ… æƒ…å†µ3ï¼šå®‰è£…/æ›´æ–°ä¾èµ–å
echo "ä¾èµ–æ›´æ–°åæ¸…ç†ç¼“å­˜..."
cd frontend && rm -rf .next node_modules/.cache
cd backend && rm -rf .tmp node_modules/.cache

# âœ… æƒ…å†µ4ï¼šGitåˆ‡æ¢åˆ†æ”¯å
echo "åˆ†æ”¯åˆ‡æ¢åæ¸…ç†ç¼“å­˜..."
rm -rf frontend/.next backend/.tmp

# âœ… æƒ…å†µ5ï¼šæ ·å¼æˆ–ç»„ä»¶å¤§å¹…ä¿®æ”¹å
echo "æ ·å¼ä¿®æ”¹åæ¸…ç†ç¼“å­˜..."
cd frontend && rm -rf .next

# ğŸ”¥ ç¼“å­˜æ¸…ç†éªŒè¯å‘½ä»¤
echo "éªŒè¯ç¼“å­˜å·²æ¸…ç†..."
! test -d frontend/.next && echo "âœ… å‰ç«¯ç¼“å­˜å·²æ¸…ç†" || echo "âŒ å‰ç«¯ç¼“å­˜æœªæ¸…ç†"
! test -d backend/.tmp && echo "âœ… åç«¯ç¼“å­˜å·²æ¸…ç†" || echo "âŒ åç«¯ç¼“å­˜æœªæ¸…ç†"
```

### **ğŸ“‹ Gitå·¥ä½œæµå¼ºåˆ¶è§„èŒƒ**
```bash
# ğŸ”¥ æ¯æ¬¡ä»£ç æäº¤å‰å¿…é¡»æ‰§è¡Œçš„æ£€æŸ¥æ¸…å•

# âœ… ç¬¬1æ­¥ï¼šä»£ç è´¨é‡æ£€æŸ¥
npm run lint                     # ESLintæ£€æŸ¥
npm run type-check              # TypeScriptæ£€æŸ¥  
npm run test                    # å•å…ƒæµ‹è¯•

# âœ… ç¬¬2æ­¥ï¼šæ„å»ºéªŒè¯
cd frontend && npm run build    # å‰ç«¯æ„å»ºæµ‹è¯•
cd backend && npm run build     # åç«¯æ„å»ºæµ‹è¯•

# âœ… ç¬¬3æ­¥ï¼šAPIåŠŸèƒ½éªŒè¯
curl -s "http://localhost:1337/api/articles" | jq '.data | length'

# âœ… ç¬¬4æ­¥ï¼šæäº¤ä¿¡æ¯è§„èŒƒ
# æ ¼å¼ï¼š<type>(<scope>): <description>
# ç¤ºä¾‹ï¼š
git commit -m "feat(auth): add email verification system"
git commit -m "fix(api): resolve pagination bug in articles endpoint"  
git commit -m "docs: update API documentation for email system"

# ç±»å‹è¯´æ˜ï¼š
# feat: æ–°åŠŸèƒ½
# fix: ä¿®å¤bug
# docs: æ–‡æ¡£æ›´æ–°
# style: ä»£ç æ ¼å¼ä¿®æ”¹
# refactor: ä»£ç é‡æ„
# test: æµ‹è¯•ä»£ç 
# chore: æ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·çš„å˜åŠ¨
```

### **ğŸ“¦ ä¾èµ–ç®¡ç†å¼ºåˆ¶è§„èŒƒ**
```bash
# ğŸ”¥ å®‰è£…ä¾èµ–æ—¶å¿…é¡»éµå¾ªçš„è§„èŒƒï¼Œé¿å…ç‰ˆæœ¬å†²çª

# âœ… ç¬¬1æ­¥ï¼šæ£€æŸ¥ä¾èµ–å…¼å®¹æ€§
echo "æ£€æŸ¥Node.jsç‰ˆæœ¬..."
node --version | grep -q "v18\|v20" && echo "âœ… Node.jsç‰ˆæœ¬å…¼å®¹" || echo "âŒ éœ€è¦Node.js 18+æˆ–20+"

echo "æ£€æŸ¥npmç‰ˆæœ¬..."
npm --version | grep -q "^[9-10]" && echo "âœ… npmç‰ˆæœ¬å…¼å®¹" || echo "âŒ éœ€è¦npm 9+æˆ–10+"

# âœ… ç¬¬2æ­¥ï¼šå®‰è£…ä¾èµ–çš„æ­£ç¡®æ–¹å¼
# ç”Ÿäº§ä¾èµ–
npm install package-name                # ç”Ÿäº§ä¾èµ–
npm install -D package-name            # å¼€å‘ä¾èµ–
npm install -E package-name            # é”å®šç¡®åˆ‡ç‰ˆæœ¬

# âœ… ç¬¬3æ­¥ï¼šéªŒè¯ä¾èµ–å®‰è£…
npm ls                                 # æ£€æŸ¥ä¾èµ–æ ‘
npm audit                             # å®‰å…¨å®¡è®¡
npm outdated                          # æ£€æŸ¥è¿‡æœŸä¾èµ–

# âŒ ç»å¯¹ç¦æ­¢çš„ä¾èµ–ç®¡ç†æ“ä½œ
npm install --force                    # å¼ºåˆ¶å®‰è£…å¯èƒ½å¯¼è‡´å†²çª
rm -rf node_modules && npm install    # é™¤éå¿…è¦ä¸è¦åˆ é™¤node_modules
npm install --save-exact              # é™¤éç‰¹æ®Šéœ€æ±‚ä¸è¦é”å®šæ‰€æœ‰ç‰ˆæœ¬

# ğŸ”¥ package.jsonç‰ˆæœ¬è§„èŒƒ
{
  "dependencies": {
    "next": "^14.0.0",              // å…è®¸å°ç‰ˆæœ¬æ›´æ–°
    "react": "^18.0.0",             // å…è®¸å°ç‰ˆæœ¬æ›´æ–°
    "strapi": "5.20.0"              // é”å®šç¡®åˆ‡ç‰ˆæœ¬ï¼ˆå…³é”®ä¾èµ–ï¼‰
  }
}
```

### **ğŸ” è°ƒè¯•å’Œæ—¥å¿—å¼ºåˆ¶è§„èŒƒ**
```typescript
// ğŸ”¥ è°ƒè¯•ä¿¡æ¯å¿…é¡»ä½¿ç”¨æ ‡å‡†æ ¼å¼ï¼Œä¾¿äºé—®é¢˜å®šä½

// âœ… å‰ç«¯è°ƒè¯•æ ‡å‡†æ ¼å¼
const debugLog = (context: string, data: any) => {
  if (process.env.NODE_ENV === 'development') {
    console.group(`ğŸ” [${context}] ${new Date().toISOString()}`)
    console.log('æ•°æ®:', data)
    console.log('è°ƒç”¨æ ˆ:', new Error().stack)
    console.groupEnd()
  }
}

// ä½¿ç”¨ç¤ºä¾‹
debugLog('APIè°ƒç”¨', { url, params, response })
debugLog('çŠ¶æ€æ›´æ–°', { oldState, newState, action })

// âœ… åç«¯æ—¥å¿—æ ‡å‡†æ ¼å¼
export const logger = {
  info: (message: string, meta?: any) => {
    console.log(JSON.stringify({
      level: 'info',
      timestamp: new Date().toISOString(),
      message,
      meta,
      service: 'aibianx-backend'
    }))
  },
  
  error: (message: string, error?: Error, meta?: any) => {
    console.error(JSON.stringify({
      level: 'error',
      timestamp: new Date().toISOString(),
      message,
      error: error ? {
        name: error.name,
        message: error.message,
        stack: error.stack
      } : undefined,
      meta,
      service: 'aibianx-backend'
    }))
  }
}

// âŒ ç»å¯¹ç¦æ­¢çš„è°ƒè¯•æ–¹å¼
console.log('debug')                    // æ— ä¸Šä¸‹æ–‡ä¿¡æ¯
console.log(largeObject)               // å¯èƒ½å¯¼è‡´å†…å­˜é—®é¢˜
alert('debug')                         // å½±å“ç”¨æˆ·ä½“éªŒ
debugger                               // å¯èƒ½è¢«æäº¤åˆ°ç”Ÿäº§ç¯å¢ƒ
```

### **ğŸ’¡ æ•ˆç‡æå‡æŠ€å·§**
```bash
# ğŸ”¥ å°†æ£€æŸ¥å‘½ä»¤è®¾ç½®ä¸ºåˆ«åï¼Œæé«˜æ•ˆç‡
alias pre-commit='./scripts.sh tools verify-deployment'
alias quick-check='npm run lint && npm run type-check && npm run test'
alias cache-clean='rm -rf frontend/.next backend/.tmp'
alias api-test='curl -s "http://localhost:1337/api/articles" | jq ".data | length"'

# ä½¿ç”¨æ–¹å¼
pre-commit           # å®Œæ•´çš„æäº¤å‰æ£€æŸ¥
quick-check         # å¿«é€Ÿä»£ç è´¨é‡æ£€æŸ¥
cache-clean         # å¿«é€Ÿæ¸…ç†ç¼“å­˜
api-test           # å¿«é€ŸAPIæµ‹è¯•
```