{
  "kind": "collectionType",
  "collectionName": "invitations",
  "info": {
    "singularName": "invitation",
    "pluralName": "invitations",
    "displayName": "邀请记录",
    "description": "邀请系统 - 管理用户邀请关系和奖励信息"
  },
  "options": {
    "draftAndPublish": false
  },
  "attributes": {
    "inviter": {
      "type": "relation",
      "relation": "manyToOne",
      "target": "plugin::users-permissions.user",
      "required": true,
      "description": "邀请人（必须是会员）"
    },
    "invitee": {
      "type": "relation",
      "relation": "manyToOne",
      "target": "plugin::users-permissions.user",
      "description": "被邀请人"
    },
    "inviteCode": {
      "type": "string",
      "required": true,
      "maxLength": 20,
      "description": "使用的邀请码"
    },
    "inviteChannel": {
      "type": "enumeration",
      "enum": ["email", "link", "social"],
      "description": "邀请渠道"
    },
    "status": {
      "type": "enumeration",
      "enum": ["sent", "registered", "purchased", "expired"],
      "default": "sent",
      "description": "邀请状态流转"
    },
    "inviterReward": {
      "type": "decimal",
      "default": 0,
      "description": "邀请人现金返佣（被邀请人购买会员后发放）"
    },
    "inviteeReward": {
      "type": "decimal",
      "default": 0,
      "description": "被邀请人优惠金额（注册时立即可用）"
    },
    "rewardStatus": {
      "type": "enumeration",
      "enum": ["pending", "granted", "expired"],
      "default": "pending",
      "description": "奖励状态"
    },
    "inviteeCoupon": {
      "type": "string",
      "description": "被邀请人专属优惠券代码"
    },
    "inviterBonus": {
      "type": "decimal",
      "default": 0,
      "description": "邀请人阶段性奖励（达到邀请目标时）"
    },
    "invitedAt": {
      "type": "datetime",
      "description": "邀请发送时间"
    },
    "registeredAt": {
      "type": "datetime",
      "description": "被邀请人注册时间"
    },
    "purchasedAt": {
      "type": "datetime",
      "description": "被邀请人首次购买时间"
    },
    "expiredAt": {
      "type": "datetime",
      "description": "邀请过期时间（30天内有效）"
    },
    "clickCount": {
      "type": "integer",
      "default": 0,
      "description": "邀请链接点击次数"
    },
    "emailOpened": {
      "type": "boolean",
      "default": false,
      "description": "邀请邮件是否打开"
    },
    "lastClickAt": {
      "type": "datetime",
      "description": "最后点击时间"
    }
  }
}